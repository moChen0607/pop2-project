<!-- saved from url=(0024)http://docs.autodesk.com -->

<!--
// ==========================================================================
// Copyright 1995,2006,2008 Autodesk, Inc. All rights reserved.
//
// Use of this software is subject to the terms of the Autodesk
// license agreement provided at the time of installation or download,
// or which otherwise accompanies this software in either electronic
// or hard copy form.
// ==========================================================================
-->
<HTML>
<HEAD><TITLE>Maya Command Engine Tests</TITLE>
<SCRIPT LANGUAGE="VBScript">
<!--
Sub SendCommand(Command)
   Dim MEL
   Set MEL = CreateObject("Maya.CommandEngine.MEL")
   On Error Resume Next
   MEL.Connect()
   If Not MEL.Connected Then
      MsgBox "Error: " & Err.Description
      Err.Clear
      Exit Sub
   End If
   MEL.Execute(Command)
   MEL.Disconnect()
End Sub
Sub NewSceneButton_OnClick
   Call SendCommand("file -f -new")
End Sub
Sub SelectAllButton_OnClick
   Call SendCommand("select -all")
End Sub
Sub FitPanelButton_OnClick
   Call SendCommand("fitPanel -selected")
End Sub
Sub DisplayShadedButton_OnClick
   Call SendCommand("DisplayShaded")
End Sub
Sub DisplayWireframeButton_OnClick
   Call SendCommand("DisplayWireframe")
End Sub
Sub SphereButton_OnClick
   Call SendCommand("performNurbsSphere 0")
End Sub
Sub CubeButton_OnClick
   Call SendCommand("performNurbsCube 0")
End Sub
Sub ConeButton_OnClick
   Call SendCommand("performNurbsCone 0")
End Sub
Sub CylinderButton_OnClick
   Call SendCommand("performNurbsCylinder 0")
End Sub
Sub PlaneButton_OnClick
   Call SendCommand("performNurbsPlane 0")
End Sub
Sub TorusButton_OnClick
   Call SendCommand("performNurbsTorus 0")
End Sub
Sub RenderButton_OnClick
   Dim MEL
   Set MEL = CreateObject("Maya.CommandEngine.MEL")
   On Error Resume Next
   MEL.Connect()
   If Not MEL.Connected Then
      MsgBox "Error: " & Err.Description
      Err.Clear
      Exit Sub
   End If
   MEL.Execute("getAttr defaultRenderGlobals.imageFormat")
   var oldFormat
   oldFormat = MEL.Result
   MEL.Execute("setAttr defaultRenderGlobals.imageFormat 8")
   MEL.Execute("render")
   var imagePath
   imagePath = MEL.Result
   Dim TheImage
   Set TheImage = Document.images("RenderImage")
   TheImage.src = imagePath
   MEL.Execute("setAttr defaultRenderGlobals.imageFormat " & oldFormat)
   MEL.Disconnect()
End Sub
Sub ClearButton_OnClick
   Dim TheImage
   Set TheImage = Document.images("RenderImage")
   TheImage.src = "blank.jpg"
End Sub
Sub CubesButton_OnClick
   Dim MEL
   Set MEL = CreateObject("Maya.CommandEngine.MEL")
   On Error Resume Next
   MEL.Connect()
   If Not MEL.Connected Then
      MsgBox "Error: " & Err.Description
      Err.Clear
      Exit Sub
   End If
   MEL.Execute("file -f -new")
   Dim x, y, z
   For x = -10 To 10 Step 2
      For y = -10 to 10 Step 2
         For z = -10 to 10 Step 2
            If Abs(x) = 10 Or Abs(y) = 10 Or Abs(z) = 10 Then
               MEL.Execute("polyCube; scale 1.5 1.5 1.5; move " & x & " " & y & " " & z)
            End If
         Next
      Next
   Next
   MEL.Execute("DisplayShaded; select -cl; fitPanel -selected")
   MEL.Disconnect()
End Sub
Sub SendButton_OnClick
   Dim TheForm
   Set TheForm = Document.forms("Form2")
   Dim CommandText
   CommandText = TheForm.Command.value
   Dim MEL
   Set MEL = CreateObject("Maya.CommandEngine.MEL")
   On Error Resume Next
   MEL.Connect()
   If Not MEL.Connected Then
      MsgBox "Error: " & Err.Description
      Err.Clear
      Exit Sub
   End If
   MEL.Execute(CommandText)
   Dim Result
   If VarType(MEL.Result) >= vbArray Then
      Result = "{ " & Join(MEL.Result, ", ") & " }"
   Else
      Result = MEL.Result
   End If
   TheForm.Result.value = Result
   MEL.Disconnect()
End Sub
-->
</SCRIPT>
</HEAD>
<BODY>
<H2>Maya Command Engine Tests</H2>
<H3>VBScript ("Maya.CommandEngine.MEL" Object) Examples</H3>
<HR><FORM ID="Form1">
   <!--
   Port Name:
   <input name="PortName" type="text" value="" id="PortName">
   <hr>
   -->
   <INPUT NAME="NewSceneButton" TYPE="BUTTON" VALUE="New Scene" ID="NewSceneButton">
   <INPUT NAME="SelectAllButton" TYPE="BUTTON" VALUE="Select All" ID="SelectAllButton">
   <INPUT NAME="FitPanelButton" TYPE="BUTTON" VALUE="Fit Panel" ID="FitPanelButton">
   <INPUT NAME="DisplayShadedButton" TYPE="BUTTON" VALUE="Display Shaded" ID="Button1">
   <INPUT NAME="DisplayWireframeButton" TYPE="BUTTON" VALUE="Display Wireframe" ID="DisplayWireframeButton">
   <p>
   <INPUT NAME="SphereButton" TYPE="BUTTON" VALUE="Sphere" ID="SphereButton">
   <INPUT NAME="CubeButton" TYPE="BUTTON" VALUE="Cube" ID="CubeButton">
   <INPUT NAME="CylinderButton" TYPE="BUTTON" VALUE="Cylinder" ID="CylinderButton">
   <INPUT NAME="ConeButton" TYPE="BUTTON" VALUE="Cone" ID="ConeButton">
   <INPUT NAME="PlaneButton" TYPE="BUTTON" VALUE="Plane" ID="PlaneButton">
   <INPUT NAME="TorusButton" TYPE="BUTTON" VALUE="Torus" ID="TorusButton">
   <hr>
   Scenes:
   <INPUT NAME="CubesButton" TYPE="BUTTON" VALUE="BIG Cube" ID="CubesButton">
   <hr><p>
   <INPUT NAME="RenderButton" TYPE="BUTTON" VALUE="Render" ID="RenderButton">
   <img name="RenderImage" id="RenderImage" src="blank.jpg">
   <INPUT NAME="ClearButton" TYPE="BUTTON" VALUE="Clear" ID="ClearButton">
   <p>
</form>
<HR><FORM ID="Form2">
   MEL Command(s):<br>
   <textarea name="Command" rows="4" cols="80" id="Command"></textarea>
   <INPUT NAME="SendButton" TYPE="BUTTON" VALUE="Send" ID="SendButton">
   <p>Result:<br>
   <textarea name="Result" rows="16" cols="80" id="Result" readonly="true"></textarea>
</FORM>
<hr>
<h3>MEL URL Protocol Links</h3>
<table cols="2" border="1" cellpadding="4">
<tr>
<td>Legacy</td>
<td>New</td>
<td>with Command Port</td>
</tr>
<tr>
<td><a href="mel://file%20-f%20-new/">mel://file -f -new/</a></td>
<td><a href="mel:file%20-f%20-new">mel:file -f -new</a></td>
<td><a href="mel://commandportDefault/file%20-f%20-new">mel://commandportDefault/file -f -new</a></td>
</tr>
<tr>
<td><a href="mel://nurbsCube/">mel://nurbsCube/</a></td>
<td><a href="mel:nurbsCube">mel:nurbsCube</a></td>
<td><a href="mel://commandportDefault/nurbsCube">mel://commandportDefault/nurbsCube</a></td>
</tr>
<tr>
<td><a href="mel://sphere%20-radius%203/">mel://sphere -radius 3/</a></td>
<td><a href="mel:sphere%20-radius%203">mel:sphere -radius 3</a></td>
<td><a href="mel://commandportDefault/sphere%20-radius%203">mel://commandportDefault/sphere -radius 3</a></td>
</tr>
<tr>
<td><a href="mel://about/">mel://about/</a></td>
<td><a href="mel:about">mel:about</a></td>
<td><a href="mel://commandportDefault/about">mel://commandportDefault/about</a></td>
</tr>
</table>
</BODY>
</HTML>
