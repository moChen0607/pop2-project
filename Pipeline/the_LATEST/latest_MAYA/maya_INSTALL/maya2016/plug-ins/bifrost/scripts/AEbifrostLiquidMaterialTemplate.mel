// Copyright (C) 1997-2014 Autodesk, Inc., and/or its licensors.
// All rights reserved.
//
// The coded instructions, statements, computer programs, and/or related
// material (collectively the "Data") in these files contain unpublished
// information proprietary to Autodesk, Inc. ("Autodesk") and/or its licensors,
// which is protected by U.S. and Canadian federal copyright law and by
// international treaties.
//
// The Data is provided for use exclusively by You. You have the right to use,
// modify, and incorporate this Data into other products for purposes authorized 
// by the Autodesk software license agreement, without fee.
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND. AUTODESK
// DOES NOT MAKE AND HEREBY DISCLAIMS ANY EXPRESS OR IMPLIED WARRANTIES
// INCLUDING, BUT NOT LIMITED TO, THE WARRANTIES OF NON-INFRINGEMENT,
// MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE, OR ARISING FROM A COURSE 
// OF DEALING, USAGE, OR TRADE PRACTICE. IN NO EVENT WILL AUTODESK AND/OR ITS
// LICENSORS BE LIABLE FOR ANY LOST REVENUES, DATA, OR PROFITS, OR SPECIAL,
// DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES, EVEN IF AUTODESK AND/OR ITS
// LICENSORS HAS BEEN ADVISED OF THE POSSIBILITY OR PROBABILITY OF SUCH DAMAGES.

//
//	Procedure Name:
//	AEbifrostLiquidMaterialTemplate
//
//	Description Name;
//	Creates the attribute editor controls for the bifrostLiquidMaterial node
//

// ----------------------------------------------------------------------------
// ----------------------------------------------------------------------------
// Methods for managing the enable/disable state of controls
// ----------------------------------------------------------------------------
// ----------------------------------------------------------------------------
global proc AEbifrostLiquidMaterialCheckReflectionColorRemap(string $nodeName)
{
	string $reflectionColorRemapChannel = `getAttr ($nodeName + ".reflectionColorRemapChannel")`;
	int $reflectionColorRemapEnable = ($reflectionColorRemapChannel != "");

	editorTemplate -dimControl $nodeName "reflectionColor" $reflectionColorRemapEnable;
	AEbifrostvisRemapEnable $nodeName "reflectionColorRemap" "reflectionColorValueRemap" $reflectionColorRemapEnable;
}

global proc AEbifrostLiquidMaterialCheckReflectionWeightRemap(string $nodeName)
{
	string $reflectionWeightRemapChannel = `getAttr ($nodeName + ".reflectionWeightRemapChannel")`;
	int $reflectionWeightRemapEnable = ($reflectionWeightRemapChannel != "");

	editorTemplate -dimControl $nodeName "reflectionWeight" $reflectionWeightRemapEnable;
	AEbifrostvisRemapEnable $nodeName "" "reflectionWeightRemap" $reflectionWeightRemapEnable;
}

global proc AEbifrostLiquidMaterialCheckFresnel(string $node)
{
	int $enabled = `getAttr ($node + ".brdfFresnel")`;
	editorTemplate -dimControl $node "brdfZeroDegree" ($enabled);
	editorTemplate -dimControl $node "brdfNinetyDegree" ($enabled);
	editorTemplate -dimControl $node "brdfCurve" ($enabled);
}

global proc AEbifrostLiquidMaterialCheckRefractionMaxDistance(string $node)
{
	int $enabled = !(`getAttr ($node + ".refractionUseColorAtMaxDistance")`);
	editorTemplate -dimControl $node "refractionMaxDistance" ($enabled);
}

global proc AEbifrostLiquidMaterialCheckRefractionColorRemap(string $nodeName)
{
	string $refractionColorRemapChannel = `getAttr ($nodeName + ".refractionColorRemapChannel")`;
	int $refractionColorRemapEnable = ($refractionColorRemapChannel != "");

	editorTemplate -dimControl $nodeName "refractionColor" $refractionColorRemapEnable;
	AEbifrostvisRemapEnable $nodeName "refractionColorRemap" "refractionColorValueRemap" $refractionColorRemapEnable;
}

global proc AEbifrostLiquidMaterialCheckTransparencyRemap(string $nodeName)
{
	string $transparencyRemapChannel = `getAttr ($nodeName + ".transparencyRemapChannel")`;
	int $transparencyRemapEnable = ($transparencyRemapChannel != "");

	editorTemplate -dimControl $nodeName "transparency" $transparencyRemapEnable;
	AEbifrostvisRemapEnable $nodeName "" "transparencyRemap" $transparencyRemapEnable;
}

global proc AEbifrostLiquidMaterialCheckFoamColorRemap(string $nodeName)
{
	string $foamColorRemapChannel = `getAttr ($nodeName + ".foamColorRemapChannel")`;
	int $foamColorRemapEnable = ($foamColorRemapChannel != "");

	editorTemplate -dimControl $nodeName "foamColor" $foamColorRemapEnable;
	AEbifrostvisRemapEnable $nodeName "foamColorRemap" "foamColorValueRemap" $foamColorRemapEnable;
}

global proc AEbifrostLiquidMaterialCheckFoamWeightRemap(string $nodeName)
{
	string $foamWeightRemapChannel = `getAttr ($nodeName + ".foamWeightRemapChannel")`;
	int $foamWeightRemapEnable = ($foamWeightRemapChannel != "");

	editorTemplate -dimControl $nodeName "foamWeight" $foamWeightRemapEnable;
	AEbifrostvisRemapEnable $nodeName "" "foamWeightRemap" $foamWeightRemapEnable;
}

global proc AEbifrostLiquidMaterialCheckDiffuseColorRemap(string $nodeName)
{
	string $diffuseColorRemapChannel = `getAttr ($nodeName + ".diffuseColorRemapChannel")`;
	int $diffuseColorRemapEnable = ($diffuseColorRemapChannel != "");

	editorTemplate -dimControl $nodeName "diffuseColor" $diffuseColorRemapEnable;
	AEbifrostvisRemapEnable $nodeName "diffuseColorRemap" "diffuseColorValueRemap" $diffuseColorRemapEnable;
}


// ----------------------------------------------------------------------------
// ----------------------------------------------------------------------------
// Main template definition
// ----------------------------------------------------------------------------
// ----------------------------------------------------------------------------
global proc AEbifrostLiquidMaterialTemplate(string $nodeName)
{
	AEswatchDisplay $nodeName;
	AEbifrostvisCommonTemplate;

	editorTemplate -beginScrollLayout;

		// Shader Type drop-down list
		editorTemplate -callCustom AEshaderTypeNew AEshaderTypeReplace "message";

		// Reflection controls
		editorTemplate -beginLayout (getPluginResource("bifrostvisplugin", "kLiquidReflection")) -collapse 0;
			editorTemplate -label (getPluginResource("bifrostvisplugin", "kRoughness")) -addControl "reflectionRoughness";

			editorTemplate -label (getPluginResource("bifrostvisplugin", "kColor")) -addControl "reflectionColor";
			editorTemplate -callCustom "AEbifrostvisChannelListNew" "AEbifrostvisChannelListReplace"
				"reflectionColorRemapChannel" "kColorRemapChannel" "kVoxel" "AEbifrostLiquidMaterialCheckReflectionColorRemap";
			editorTemplate -callCustom "AEbifrostvisRemapNew" "AEbifrostvisRemapReplace"
				"reflectionColorRemapInputMin" "reflectionColorRemapInputMax" "reflectionColorRemap" "reflectionColorValueRemap"
				"kLiquidReflectionColorRemap" "kMin" "kMax" "AEbifrostLiquidMaterialCheckReflectionColorRemap";

			editorTemplate -addSeparator;

			editorTemplate -label (getPluginResource("bifrostvisplugin", "kWeight")) -addControl "reflectionWeight";
			editorTemplate -callCustom "AEbifrostvisChannelListNew" "AEbifrostvisChannelListReplace"
				"reflectionWeightRemapChannel" "kWeightRemapChannel" "kVoxel" "AEbifrostLiquidMaterialCheckReflectionWeightRemap";
			editorTemplate -callCustom "AEbifrostvisRemapNew" "AEbifrostvisRemapReplace"
				"reflectionWeightRemapInputMin" "reflectionWeightRemapInputMax" "" "reflectionWeightRemap"
				"kLiquidReflectionWeightRemap" "kMin" "kMax" "AEbifrostLiquidMaterialCheckReflectionWeightRemap";

			editorTemplate -beginLayout (getPluginResource("bifrostvisplugin", "kLiquidFresnelControls")) -collapse 0;
				editorTemplate -label (getPluginResource("bifrostvisplugin", "kLiquidFresnelIOR")) -addControl "reflectionFresnelIOR";
				editorTemplate -label (getPluginResource("bifrostvisplugin", "kLiquidFresnel")) -addControl "brdfFresnel" "AEbifrostLiquidMaterialCheckFresnel";
				editorTemplate -label (getPluginResource("bifrostvisplugin", "kLiquidZeroDegree")) -addControl "brdfZeroDegree";
				editorTemplate -label (getPluginResource("bifrostvisplugin", "kLiquidNinetyDegree")) -addControl "brdfNinetyDegree";
				editorTemplate -label (getPluginResource("bifrostvisplugin", "kLiquidCurveExponent")) -addControl "brdfCurve";
			editorTemplate -endLayout;
		editorTemplate -endLayout;

		// Refraction controls
		editorTemplate -beginLayout (getPluginResource("bifrostvisplugin", "kLiquidRefractionTransmission")) -collapse 0;
			editorTemplate -addControl "indexOfRefraction";
			editorTemplate -label (getPluginResource("bifrostvisplugin", "kRoughness")) -addControl "refractionRoughness";

			editorTemplate -label (getPluginResource("bifrostvisplugin", "kColor")) -addControl "refractionColor";
			editorTemplate -label (getPluginResource("bifrostvisplugin", "kLiquidUseColorAtMaxDistance")) -addControl "refractionUseColorAtMaxDistance"
				"AEbifrostLiquidMaterialCheckRefractionMaxDistance";
			editorTemplate -label (getPluginResource("bifrostvisplugin", "kLiquidMaxDistance")) -addControl "refractionMaxDistance";
			editorTemplate -callCustom "AEbifrostvisChannelListNew" "AEbifrostvisChannelListReplace"
				"refractionColorRemapChannel" "kColorRemapChannel" "kVoxel" "AEbifrostLiquidMaterialCheckRefractionColorRemap";
			editorTemplate -callCustom "AEbifrostvisRemapNew" "AEbifrostvisRemapReplace"
				"refractionColorRemapInputMin" "refractionColorRemapInputMax" "refractionColorRemap" "refractionColorValueRemap"
				"kLiquidRefractionColorRemap" "kMin" "kMax" "AEbifrostLiquidMaterialCheckRefractionColorRemap";

			editorTemplate -addSeparator;

			editorTemplate -addControl "transparency";
			editorTemplate -callCustom "AEbifrostvisChannelListNew" "AEbifrostvisChannelListReplace"
				"transparencyRemapChannel" "kTransparencyRemapChannel" "kVoxel" "AEbifrostLiquidMaterialCheckTransparencyRemap";
			editorTemplate -callCustom "AEbifrostvisRemapNew" "AEbifrostvisRemapReplace"
				"transparencyRemapInputMin" "transparencyRemapInputMax" "" "transparencyRemap"
				"kLiquidTransparencyWeightRemap" "kMin" "kMax" "AEbifrostLiquidMaterialCheckTransparencyRemap";
		editorTemplate -endLayout;

		// Surface Foam controls
		editorTemplate -beginLayout (getPluginResource("bifrostvisplugin", "kLiquidSurfaceFoam")) -collapse 0;
			editorTemplate -label (getPluginResource("bifrostvisplugin", "kColor")) -addControl "foamColor";
			editorTemplate -callCustom "AEbifrostvisChannelListNew" "AEbifrostvisChannelListReplace"
				"foamColorRemapChannel" "kColorRemapChannel" "kVoxel" "AEbifrostLiquidMaterialCheckFoamColorRemap";
			editorTemplate -callCustom "AEbifrostvisRemapNew" "AEbifrostvisRemapReplace"
				"foamColorRemapInputMin" "foamColorRemapInputMax" "foamColorRemap" "foamColorValueRemap"
				"kLiquidSurfaceFoamColorRemap" "kMin" "kMax" "AEbifrostLiquidMaterialCheckFoamColorRemap";

			editorTemplate -addSeparator;

			editorTemplate -label (getPluginResource("bifrostvisplugin", "kWeight")) -addControl "foamWeight";
			editorTemplate -callCustom "AEbifrostvisChannelListNew" "AEbifrostvisChannelListReplace"
				"foamWeightRemapChannel" "kWeightRemapChannel" "kVoxel" "AEbifrostLiquidMaterialCheckFoamWeightRemap";
			editorTemplate -callCustom "AEbifrostvisRemapNew" "AEbifrostvisRemapReplace"
				"foamWeightRemapInputMin" "foamWeightRemapInputMax" "" "foamWeightRemap"
				"kLiquidSurfaceFoamWeightRemap" "kMin" "kMax" "AEbifrostLiquidMaterialCheckFoamWeightRemap";
		editorTemplate -endLayout;

		// Diffuse controls
		editorTemplate -beginLayout (getPluginResource("bifrostvisplugin", "kLiquidDiffuse")) -collapse 0;
			editorTemplate -label (getPluginResource("bifrostvisplugin", "kColor")) -addControl "diffuseColor";
			editorTemplate -callCustom "AEbifrostvisChannelListNew" "AEbifrostvisChannelListReplace"
				"diffuseColorRemapChannel" "kColorRemapChannel" "kVoxel" "AEbifrostLiquidMaterialCheckDiffuseColorRemap";
			editorTemplate -callCustom "AEbifrostvisRemapNew" "AEbifrostvisRemapReplace"
				"diffuseColorRemapInputMin" "diffuseColorRemapInputMax" "diffuseColorRemap" "diffuseColorValueRemap"
				"kLiquidDiffuseColorRemap" "kMin" "kMax" "AEbifrostLiquidMaterialCheckDiffuseColorRemap";
		editorTemplate -endLayout;

		// Contribution controls
		editorTemplate -beginLayout (getPluginResource("bifrostvisplugin", "kLiquidContribution"));
			editorTemplate -addControl "direct";
			editorTemplate -addControl "indirect";
		editorTemplate -endLayout;

	editorTemplate -endLayout;

	// Add parent class controls
	AEdependNodeTemplate $nodeName;

	// Add any missing controls
	editorTemplate -addExtraControls;

	editorTemplate -endScrollLayout;
}
