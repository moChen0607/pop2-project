// Copyright (C) 1997-2014 Autodesk, Inc., and/or its licensors.
// All rights reserved.
//
// The coded instructions, statements, computer programs, and/or related
// material (collectively the "Data") in these files contain unpublished
// information proprietary to Autodesk, Inc. ("Autodesk") and/or its licensors,
// which is protected by U.S. and Canadian federal copyright law and by
// international treaties.
//
// The Data is provided for use exclusively by You. You have the right to use,
// modify, and incorporate this Data into other products for purposes authorized 
// by the Autodesk software license agreement, without fee.
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND. AUTODESK
// DOES NOT MAKE AND HEREBY DISCLAIMS ANY EXPRESS OR IMPLIED WARRANTIES
// INCLUDING, BUT NOT LIMITED TO, THE WARRANTIES OF NON-INFRINGEMENT,
// MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE, OR ARISING FROM A COURSE 
// OF DEALING, USAGE, OR TRADE PRACTICE. IN NO EVENT WILL AUTODESK AND/OR ITS
// LICENSORS BE LIABLE FOR ANY LOST REVENUES, DATA, OR PROFITS, OR SPECIAL,
// DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES, EVEN IF AUTODESK AND/OR ITS
// LICENSORS HAS BEEN ADVISED OF THE POSSIBILITY OR PROBABILITY OF SUCH DAMAGES.

//
//	Procedure Name:
//	AEbifrostAeroMaterialTemplate
//
//	Description Name;
//	Creates the attribute editor controls for the bifrostAeroMaterial node
//

global proc AEbifrostAeroMaterialCheckDensityRemap(string $nodeName)
{
	string $densityRemapChannel = `getAttr ($nodeName + ".densityRemapChannel")`;
	int $densityRemapEnable = ($densityRemapChannel != "");

	editorTemplate -dimControl $nodeName "densityScale" $densityRemapEnable;
	editorTemplate -dimControl $nodeName "densityThreshold" $densityRemapEnable;
	AEbifrostvisRemapEnable $nodeName "" "densityRemap" $densityRemapEnable;
}

global proc AEbifrostAeroMaterialCheckEmissionColorRemap(string $nodeName)
{
	string $emissionColorRemapChannel = `getAttr ($nodeName + ".emissionColorRemapChannel")`;
	int $emissionColorRemapEnable = ($emissionColorRemapChannel != "");

	editorTemplate -dimControl $nodeName "emissionColor" $emissionColorRemapEnable;
	AEbifrostvisRemapEnable $nodeName "emissionColorRemap" "emissionColorValueRemap" $emissionColorRemapEnable;
}

global proc AEbifrostAeroMaterialTemplate(string $nodeName)
{
	AEswatchDisplay $nodeName;
	AEbifrostvisCommonTemplate;

	editorTemplate -beginScrollLayout;

		// Shader Type drop-down list
		editorTemplate -callCustom AEshaderTypeNew AEshaderTypeReplace "message";

		// Density controls
		editorTemplate -beginLayout (getPluginResource("bifrostvisplugin", "kDensityControls")) -collapse 0;
			editorTemplate -label (getPluginResource("bifrostvisplugin", "kScale")) -addControl "densityScale";
			editorTemplate -label (getPluginResource("bifrostvisplugin", "kThreshold")) -addControl "densityThreshold";
			editorTemplate -callCustom "AEbifrostvisChannelListNew" "AEbifrostvisChannelListReplace"
				"densityRemapChannel" "kDensityRemap" "kVoxel" "AEbifrostAeroMaterialCheckDensityRemap";
			editorTemplate -callCustom "AEbifrostvisRemapNew" "AEbifrostvisRemapReplace"
				"densityRemapInputMin" "densityRemapInputMax" "" "densityRemap"
				"kDensityRemap" "kMin" "kMax" "AEbifrostAeroMaterialCheckDensityRemap";
		editorTemplate -endLayout;

		// Emission controls
		editorTemplate -beginLayout (getPluginResource("bifrostvisplugin", "kEmissionControls")) -collapse 0;
			editorTemplate -label (getPluginResource("bifrostvisplugin", "kColor")) -addControl "emissionColor";
			editorTemplate -label (getPluginResource("bifrostvisplugin", "kIntensity")) -addControl "emissionIntensity";
			editorTemplate -label (getPluginResource("bifrostvisplugin", "kIntensityUnits")) -addControl "emissionIntensityUnits";
			editorTemplate -label (getPluginResource("bifrostvisplugin", "kOffset")) -addControl "emissionOffset";
			editorTemplate -callCustom "AEbifrostvisChannelListNew" "AEbifrostvisChannelListReplace"
				"emissionColorRemapChannel" "kEmissionColorRemapChannel" "kVoxel" "AEbifrostAeroMaterialCheckEmissionColorRemap";
			editorTemplate -callCustom "AEbifrostvisRemapNew" "AEbifrostvisRemapReplace"
				"emissionColorRemapInputMin" "emissionColorRemapInputMax" "emissionColorRemap" "emissionColorValueRemap"
				"kEmissionColorRemapControls" "kMin" "kMax" "AEbifrostAeroMaterialCheckEmissionColorRemap";
		editorTemplate -endLayout;

		// Absorption controls
		editorTemplate -beginLayout (getPluginResource("bifrostvisplugin", "kAbsorptionControls")) -collapse 0;
			editorTemplate -label (getPluginResource("bifrostvisplugin", "kColor")) -addControl "absorptionColor";
			editorTemplate -label (getPluginResource("bifrostvisplugin", "kIntensity")) -addControl "absorptionIntensity";
			editorTemplate -label (getPluginResource("bifrostvisplugin", "kOffset")) -addControl "absorptionOffset";
			editorTemplate -addControl "shadowOpacityScale";
			editorTemplate -addControl "coloredOpacity";
		editorTemplate -endLayout;

		// Scattering controls
		editorTemplate -beginLayout (getPluginResource("bifrostvisplugin", "kScatteringControls")) -collapse 0;
			editorTemplate -label (getPluginResource("bifrostvisplugin", "kColor")) -addControl "scatteringColor";
			editorTemplate -label (getPluginResource("bifrostvisplugin", "kIntensity")) -addControl "scatteringIntensity";
			editorTemplate -label (getPluginResource("bifrostvisplugin", "kOffset")) -addControl "scatteringOffset";
			editorTemplate -label (getPluginResource("bifrostvisplugin", "kDensityCutoff")) -addControl "scatteringDensityCutoff";
			editorTemplate -label (getPluginResource("bifrostvisplugin", "kDirectionality")) -addControl "scatteringDirectionality";
		editorTemplate -endLayout;

		// Display controls
		editorTemplate -beginLayout (getPluginResource("bifrostvisplugin", "kDisplayControls")) -collapse 1;
			editorTemplate -addControl "lightSteps";
			editorTemplate -addControl "lightSharpness";
		editorTemplate -endLayout;

		// Add parent class controls
		AEdependNodeTemplate $nodeName;

		// Add any missing controls
		editorTemplate -addExtraControls;

	editorTemplate -endScrollLayout;

	// Suppress meaningless attributes
	editorTemplate -suppress "densityChannel";

    // Intensity Units is not ready in 2016
	evalDeferred("editorTemplate -dimControl " + $nodeName + " \"emissionIntensityUnits\" 1");
}
