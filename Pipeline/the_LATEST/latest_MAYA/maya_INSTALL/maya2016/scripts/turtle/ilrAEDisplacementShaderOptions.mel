// Copyright (C) 1997-2014 Autodesk, Inc., and/or its licensors.
// All rights reserved.
//
// The coded instructions, statements, computer programs, and/or related
// material (collectively the "Data") in these files contain unpublished
// information proprietary to Autodesk, Inc. ("Autodesk") and/or its licensors,
// which is protected by U.S. and Canadian federal copyright law and by
// international treaties.
//
// The Data is provided for use exclusively by You. You have the right to use,
// modify, and incorporate this Data into other products for purposes authorized 
// by the Autodesk software license agreement, without fee.
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND. AUTODESK
// DOES NOT MAKE AND HEREBY DISCLAIMS ANY EXPRESS OR IMPLIED WARRANTIES
// INCLUDING, BUT NOT LIMITED TO, THE WARRANTIES OF NON-INFRINGEMENT,
// MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE, OR ARISING FROM A COURSE 
// OF DEALING, USAGE, OR TRADE PRACTICE. IN NO EVENT WILL AUTODESK AND/OR ITS
// LICENSORS BE LIABLE FOR ANY LOST REVENUES, DATA, OR PROFITS, OR SPECIAL,
// DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES, EVEN IF AUTODESK AND/OR ITS
// LICENSORS HAS BEEN ADVISED OF THE POSSIBILITY OR PROBABILITY OF SUCH DAMAGES.

//
// provided at the time of installation or download, or which otherwise accompanies 

global proc ilrUpdateAEDisplacementShaderOptions(string $parent, string $node)
{
	string $oldParent = `setParent -q`;

	setParent $parent;
	
	if (`attributeQuery -exists -node $node "ilrDisplacementMethod"`) {
		int $pt = `getAttr ($node + ".ilrDisplacementMethod")`;
		int $mt = !$pt;

		// micro triangles		
		text -e -enable $mt ilrMTLabel;
		attrFieldSliderGrp -e -enable $mt ilrMTMaxTriangles;
		attrControlGrp -e -enable $mt ilrMTLod;

		int $lodEnable = `getAttr ($node + ".ilrMTLod")` && $mt;

		attrFieldSliderGrp -e -enable $lodEnable ilrMTLodMultiplier;
		attrFieldSliderGrp -e -enable $mt ilrMTMaxRayOffset;

		// pre-tesselation
		text -e -enable $pt ilrPTLabel;
		attrFieldSliderGrp -e -enable $pt ilrPTMaxSubdivs;
		attrFieldSliderGrp -e -enable $pt ilrPTEdgeLength;
		attrFieldSliderGrp -e -enable $pt ilrPTEdgeHeight;
		attrControlGrp -e -enable $pt ilrDispNormals;

		int $dispNormalsEnable = `getAttr ($node + ".ilrDispNormals")` && $pt;

		attrFieldSliderGrp -e -enable $dispNormalsEnable ilrDispNormalsThreshold;

		// autobounds
		int $enable = !`getAttr ($node + ".ilrAutoBounds")`;

		attrFieldSliderGrp -e -enable $enable ilrLowerBound;
		attrFieldSliderGrp -e -enable $enable ilrUpperBound;
	}

	setParent $oldParent;
}

global proc ilrCreateAEDisplacementShaderOptions(string $parent, string $node)
{
	string $oldParent = `setParent -q`;

	setParent $parent;

	string $updcmd = "ilrUpdateAEDisplacementShaderOptions(\\\"" + $parent + "\\\", \\\"" + $node + "\\\")";
		
	if (`attributeQuery -exists -node $node "ilrDisplacementMethod"`) {
		attrControlGrp -label "Method"
		-attribute ($node + ".ilrDisplacementMethod")
		-changeCommand $updcmd;
		
		attrFieldSliderGrp -label "Displacement Scale"
		-attribute ($node + ".ilrDisplacementScale");
						
		attrControlGrp -label "Smooth Base Mesh"
		-attribute ($node + ".ilrSmoothBaseMesh");

		separator;
		
		text -label " Rendertime Micro Triangles" -align "left" -font "smallBoldLabelFont" ilrMTLabel;
		
		attrFieldSliderGrp -label "Max Triangles Per Edge"
		-attribute ($node + ".ilrMTMaxTriangles")
		ilrMTMaxTriangles;

		attrControlGrp -label "Enable LOD"
		-attribute ($node + ".ilrMTLod")
		-changeCommand $updcmd
		ilrMTLod;

		attrFieldSliderGrp -label "LOD Quality"
		-attribute ($node + ".ilrMTLodMultiplier")
		ilrMTLodMultiplier;

		attrFieldSliderGrp -label "Max Ray Offset"
		-attribute ($node + ".ilrMTMaxRayOffset")
		ilrMTMaxRayOffset;

		separator;

		text -label " Pre-Tesselation" -align "left" -font "smallBoldLabelFont" ilrPTLabel;

		attrFieldSliderGrp -label "Max Subdivision"
		-attribute ($node + ".ilrPTMaxSubdivs")
		ilrPTMaxSubdivs;

		attrFieldSliderGrp -label "Edge Length"
		-attribute ($node + ".ilrPTEdgeLength")
		ilrPTEdgeLength;

		attrFieldSliderGrp -label "Edge Height"
		-attribute ($node + ".ilrPTEdgeHeight")
		ilrPTEdgeHeight;

		attrControlGrp -label "Smooth Normals"
		-attribute ($node + ".ilrDispNormals")
		-changeCommand $updcmd
		ilrDispNormals;

		attrFieldSliderGrp -label "Smooth Normals Threshold"
		-attribute ($node + ".ilrDispNormalsThreshold")
		ilrDispNormalsThreshold;

		separator;

		text -label " Displacement Bounds" -align "left" -font "smallBoldLabelFont";

		attrControlGrp -label "Calculate Bounds Automatically"
		-attribute ($node + ".ilrAutoBounds")
		-changeCommand $updcmd;

		attrFieldSliderGrp -label "Lower Bound"
		-attribute ($node + ".ilrLowerBound")
		ilrLowerBound;

		attrFieldSliderGrp -label "Upper Bound"
		-attribute ($node + ".ilrUpperBound")
		ilrUpperBound;

	}

	setParent $oldParent;
	
	ilrUpdateAEDisplacementShaderOptions($parent, $node);
}