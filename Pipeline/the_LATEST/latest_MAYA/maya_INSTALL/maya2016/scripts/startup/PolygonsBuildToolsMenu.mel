// Copyright (C) 1997-2014 Autodesk, Inc., and/or its licensors.
// All rights reserved.
//
// The coded instructions, statements, computer programs, and/or related
// material (collectively the "Data") in these files contain unpublished
// information proprietary to Autodesk, Inc. ("Autodesk") and/or its licensors,
// which is protected by U.S. and Canadian federal copyright law and by
// international treaties.
//
// The Data is provided for use exclusively by You. You have the right to use,
// modify, and incorporate this Data into other products for purposes authorized 
// by the Autodesk software license agreement, without fee.
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND. AUTODESK
// DOES NOT MAKE AND HEREBY DISCLAIMS ANY EXPRESS OR IMPLIED WARRANTIES
// INCLUDING, BUT NOT LIMITED TO, THE WARRANTIES OF NON-INFRINGEMENT,
// MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE, OR ARISING FROM A COURSE 
// OF DEALING, USAGE, OR TRADE PRACTICE. IN NO EVENT WILL AUTODESK AND/OR ITS
// LICENSORS BE LIABLE FOR ANY LOST REVENUES, DATA, OR PROFITS, OR SPECIAL,
// DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES, EVEN IF AUTODESK AND/OR ITS
// LICENSORS HAS BEEN ADVISED OF THE POSSIBILITY OR PROBABILITY OF SUCH DAMAGES.

global proc modelingToolkitLoadCallbackProc( string $pluginName ) 
{
	if($pluginName == "modelingToolkit")
	{
		MTsetToggleMenuItem;
	}
}

global proc PolygonsBuildToolsMenu( string $parent )
//
// Description:
//		Modeling Mesh Tools menu (which is also the legacy Polygons Mesh Tools menu)
//
{
	if (! `isTrue "PolygonsExists"`) return;

	setParent -m $parent; 

	if (`menu -q -ni $parent` != 0) {

		MTsetToggleMenuItem;

		// Else build all UI
	}else{

		menuItem
			-c "ToggleModelingToolkit"
			-version "2014"
			ToggleModelingToolkitMenuItem;

		menuItem -divider true -dividerLabel (uiRes("m_PolygonsBuildToolsMenu.kToolsDivider"));

			menuItem -label (uiRes("m_PolygonsBuildToolsMenu.kPolyBuildApndToPolyTool1"))
				-i "polyAppendFacet.png"
				-annotation (uiRes("m_PolygonsBuildToolsMenu.kPolyBuildApndToPolyToolAnnot"))
				-ddc "setToolTo polyAppendFacetContext ; polyAppendFacetCtx -e -pc `optionVar -q polyKeepFacetsPlanar` polyAppendFacetContext; toolPropertyWindow"
				-dmc "polygonsMenuItemToShelf \"setToolTo polyAppendFacetContext ; polyAppendFacetCtx -e -pc `optionVar -q polyKeepFacetsPlanar` polyAppendFacetContext\""
				-c "AppendToPolygonTool" appendItem;

			menuItem -optionBox 1 -i "polyAppendFacet.png" 
				-annotation (uiRes("m_PolygonsBuildToolsMenu.kPolyBuildApndToPolyToolOptionsAnnot"))
				-ecr false 
				-c "AppendToPolygonToolOptions" appendOptionItem;

			menuItem
				-label (uiRes("m_PolygonsBuildToolsMenu.kMTKConnectTool1"))
				-annotation (uiRes("m_PolygonsBuildToolsMenu.kMTKConnectToolAnn"))
				-command "dR_connectTool" 
				-dragDoubleClickCommand "dR_connectTool; toolPropertyWindow;" 				
				-image "connect_NEX32.png" 
				MTKConnectTool;

			menuItem
				-label (uiRes("m_PolygonsBuildToolsMenu.kMTKConnectToolOptions"))
				-annotation (uiRes( "m_PolygonsBuildToolsMenu.kMTKConnectToolAnn"))
				-command "dR_connectTool; toolPropertyWindow;"
				-optionBox 1
				-image "connect_NEX32.png" 
				;

			menuItem
				-label (uiRes("m_PolygonsBuildToolsMenu.kCreaseTool1"))
				-annotation (getRunTimeCommandAnnotation("PolyCreaseTool"))
				-command "PolyCreaseTool" 
				-enableCommandRepeat 1
				-image "polyCrease.png" 
				;

			menuItem
				-label (uiRes("m_PolygonsBuildToolsMenu.kCreaseToolOptions"))
				-annotation (getRunTimeCommandAnnotation("PolyCreaseToolOptions"))
				-command "PolyCreaseToolOptions" 
				-optionBox 1
				-enableCommandRepeat 1
				-image "polyCrease.png" 
				;

			menuItem 
				-label (uiRes("m_PolygonsBuildToolsMenu.kCreatePolyToo1l"))
				-annotation (uiRes("m_PolygonsBuildToolsMenu.kCreatePolyToolAnnot"))
				-image "polyCreateFacet.png"
				-command "CreatePolygonTool" 
				-dragDoubleClickCommand "setToolTo polyCreateFacetContext ; polyCreateFacetCtx -e -pc `optionVar -q polyKeepFacetsPlanar` polyCreateFacetContext; toolPropertyWindow"
				-dragMenuCommand "polygonsMenuItemToShelf \"setToolTo polyCreateFacetContext ; polyCreateFacetCtx -e -pc `optionVar -q polyKeepFacetsPlanar` polyCreateFacetContext\""
				;
				
			menuItem -optionBox true 
				-annotation (uiRes("m_PolygonsBuildToolsMenu.kCreatePolyToolOptionsAnnot"))
				-image "polyCreateFacet.png" 
				-command "CreatePolygonToolOptions" 
				;
			
			menuItem
				-label (uiRes("m_PolygonsBuildToolsMenu.kPolyBuildInsertEdgeLoopTool1"))
				-annotation (getRunTimeCommandAnnotation("SplitEdgeRingTool"))
				-image "polySplitEdgeRing.png"
				-command "SplitEdgeRingTool"
				-dragDoubleClickCommand "InsertEdgeLoopToolOptions"
				;

			menuItem -optionBox true
				-annotation (getRunTimeCommandAnnotation("SplitEdgeRingToolOptions"))
				-image "polySplitEdgeRing.png" 
				-command "SplitEdgeRingToolOptions" 
				;

			menuItem
				-label (uiRes("m_PolygonsBuildToolsMenu.kNewMakeHoleTool1"))
				-annotation (getRunTimeCommandAnnotation("MakeHoleTool"))
				-image "polyMergeFacet.png"
				-command "MakeHoleTool"
				-dragDoubleClickCommand "MakeHoleToolOptions"
				;

			menuItem -optionBox true
				-annotation (getRunTimeCommandAnnotation("MakeHoleToolOptions"))
				-image "polyMergeFacet.png" 
				-command "MakeHoleToolOptions"
				;

			menuItem
				-version "2015"
				-label (uiRes("m_PolygonsBuildToolsMenu.kMTKMultiCutTool"))
				-annotation (uiRes("m_PolygonsBuildToolsMenu.kMTKMultiCutToolAnn"))
				-command "dR_multiCutTool" 
				-dragDoubleClickCommand "dR_multiCutTool; toolPropertyWindow;" 
				-image "multiCut_NEX32.png" 
				MTKMultiCutTool;

			menuItem
				-label (uiRes("m_PolygonsBuildToolsMenu.kMTKMultiCutToolOptions"))
				-annotation (uiRes( "m_PolygonsBuildToolsMenu.kMTKMultiCutToolAnn"))
				-command "dR_multiCutTool;  toolPropertyWindow;" 
				-optionBox 1
				-image "multiCut_NEX32.png" 
				;

			menuItem
				-label (uiRes("m_PolygonsBuildToolsMenu.kPolyBuildOffsetEdgeLoopTool1"))
				-annotation (uiRes("m_PolygonsBuildToolsMenu.kPolyBuildOffsetEdgeLoopToolAnnot"))
				-image "polyDuplicateEdgeLoop.png" 
				-command "DuplicateEdges"
				-dragMenuCommand "performPolyDuplicateEdge 2"
				-dragDoubleClickCommand "DuplicateEdgesOptions"
				EditPolygonDuplicateEdgesItem
				;

			menuItem -optionBox true
				-annotation (uiRes("m_PolygonsBuildToolsMenu.kPolyBuildDuplicateEdgeLoopToolOptions"))
				-image "polyDuplicateEdgeLoop.png" 
				-command "DuplicateEdgesOptions"
				EditPolygonDuplicateEdgesOptionsItem
				;

			menuItem
				-label (uiRes("m_PolygonsBuildToolsMenu.kNewPolyReduceWeightsTool1")) 
				-annotation (getRunTimeCommandAnnotation("PaintReduceWeightsTool"))
				-image "polyPaintReduceWeights.png"
				-command "PaintReduceWeightsTool"
				-dragDoubleClickCommand "PaintReduceWeightsToolOptions"
				;

			menuItem -optionBox true
				-annotation (getRunTimeCommandAnnotation("PaintReduceWeightsToolOptions"))
				-image "polyReduce.png" 
				-command "PaintReduceWeightsToolOptions" 
				;

			menuItem -label (uiRes("m_PolygonsBuildToolsMenu.kPaintTransferAttributesWeightsTool1"))  
				-annotation (uiRes("m_PolygonsBuildToolsMenu.kPaintTransferAttributesWeightsToolAnnot1"))
				-image "polyTransferAttributesWeights.png"
				-command "artAttrToolScript 4 \"transferAttributes\"" wtPaintItem;
			
			menuItem -optionBox true 
				-annotation (uiRes("m_PolygonsBuildToolsMenu.kPaintTransferAttributesWeightsToolOptionAnnot1")) 
				-image "polyTransferAttributesWeights.png"
				-command "artAttrToolScript 3 \"transferAttributes\"" wtPaintDialogItem;

			menuItem
				-label (uiRes("m_PolygonsBuildToolsMenu.kMTKQuadDrawTool1"))
				-annotation (uiRes("m_PolygonsBuildToolsMenu.kMTKQuadDrawToolAnn"))
				-command "dR_quadDrawTool" 
				-dragDoubleClickCommand "dR_quadDrawTool; toolPropertyWindow;" 
				-image "quadDraw_NEX32.png" 
				MTKQuadDrawTool;

			menuItem
				-label (uiRes("m_PolygonsBuildToolsMenu.kMTKQuadDrawToolOptions"))
				-annotation (uiRes( "m_PolygonsBuildToolsMenu.kMTKQuadDrawToolAnn"))
				-command "dR_quadDrawTool; toolPropertyWindow;" 
				-optionBox 1
				-image "quadDraw_NEX32.png" 
				;

			menuItem -label (uiRes("m_PolygonsBuildToolsMenu.kPolySculptTools")) 
				-version "2016"
				-subMenu 1
				-allowOptionBoxes true 
				-tearOff 1
				-annotation (uiRes("m_PolygonsBuildToolsMenu.kPolySculptToolsAnn"))
				;

				string $label = (uiRes("m_PolygonsBuildToolsMenu.kSculptTool"));
				menuItem
					-label      $label
					-annotation `getRunTimeCommandAnnotation("SetMeshSculptTool")`
					-image     "Sculpt.png"
					-command    ("SetMeshSculptTool")
					-dragDoubleClickCommand ("ShowMeshSculptToolOptions");

				menuItem -optionBox 1 
					-image     "Sculpt.png"
					-annotation `getRunTimeCommandAnnotation("ShowMeshSculptToolOptions")`
					-enableCommandRepeat false 
					-command    "ShowMeshSculptToolOptions" ;

				$label = (uiRes("m_PolygonsBuildToolsMenu.kSmoothTool"));
				menuItem
					-label      $label
					-annotation `getRunTimeCommandAnnotation("SetMeshSmoothTool")`
					-image     "Smooth.png"
					-command    ("SetMeshSmoothTool")
					-dragDoubleClickCommand ("ShowMeshSmoothToolOptions");

				menuItem -optionBox 1 
					-image     "Smooth.png"
					-annotation `getRunTimeCommandAnnotation("ShowMeshSmoothToolOptions")`
					-enableCommandRepeat false 
					-command    "ShowMeshSmoothToolOptions" ;

				$label = (uiRes("m_PolygonsBuildToolsMenu.kRelaxTool"));
				menuItem
					-label      $label
					-annotation `getRunTimeCommandAnnotation("SetMeshRelaxTool")`
					-image     "Relax.png"
					-command    ("SetMeshRelaxTool")
					-dragDoubleClickCommand ("ShowMeshRelaxToolOptions");

				menuItem -optionBox 1 
					-image     "Relax.png"
					-annotation `getRunTimeCommandAnnotation("ShowMeshRelaxToolOptions")`
					-enableCommandRepeat false 
					-command    "ShowMeshRelaxToolOptions" ;

				$label = (uiRes("m_PolygonsBuildToolsMenu.kGrabTool"));
				menuItem
					-label      $label
					-annotation `getRunTimeCommandAnnotation("SetMeshGrabTool")`
					-image     "Grab.png"
					-command    ("SetMeshGrabTool")
					-dragDoubleClickCommand ("ShowMeshGrabToolOptions");

				menuItem -optionBox 1 
					-image     "Grab.png"
					-annotation `getRunTimeCommandAnnotation("ShowMeshGrabToolOptions")`
					-enableCommandRepeat false 
					-command    "ShowMeshGrabToolOptions" ;

				$label = (uiRes("m_PolygonsBuildToolsMenu.kPinchTool"));
				menuItem
					-label      $label
					-annotation `getRunTimeCommandAnnotation("SetMeshPinchTool")`
					-image     "Pinch.png"
					-command    ("SetMeshPinchTool")
					-dragDoubleClickCommand ("ShowMeshPinchToolOptions");

				menuItem -optionBox 1 
					-image     "Pinch.png"
					-annotation `getRunTimeCommandAnnotation("ShowMeshPinchToolOptions")`
					-enableCommandRepeat false 
					-command    "ShowMeshPinchToolOptions" ;

				$label = (uiRes("m_PolygonsBuildToolsMenu.kFlattenTool"));
				menuItem
					-label      $label
					-annotation `getRunTimeCommandAnnotation("SetMeshFlattenTool")`
					-image     "Flatten.png"
					-command    ("SetMeshFlattenTool")
					-dragDoubleClickCommand ("ShowMeshFlattenToolOptions");

				menuItem -optionBox 1 
					-image     "Flatten.png"
					-annotation `getRunTimeCommandAnnotation("ShowMeshFlattenToolOptions")`
					-enableCommandRepeat false 
					-command    "ShowMeshFlattenToolOptions" ;

				$label = (uiRes("m_PolygonsBuildToolsMenu.kFoamyTool"));
				menuItem
					-label      $label
					-annotation `getRunTimeCommandAnnotation("SetMeshFoamyTool")`
					-image     "Foamy.png"
					-command    ("SetMeshFoamyTool")
					-dragDoubleClickCommand ("ShowMeshFoamyToolOptions");

				menuItem -optionBox 1 
					-image     "Foamy.png"
					-annotation `getRunTimeCommandAnnotation("ShowMeshFoamyToolOptions")`
					-enableCommandRepeat false 
					-command    "ShowMeshFoamyToolOptions" ;

				$label = (uiRes("m_PolygonsBuildToolsMenu.kSprayTool"));
				menuItem
					-label      $label
					-annotation `getRunTimeCommandAnnotation("SetMeshSprayTool")`
					-image     "Spray.png"
					-command    ("SetMeshSprayTool")
					-dragDoubleClickCommand ("ShowMeshSprayToolOptions");

				menuItem -optionBox 1 
					-image     "Spray.png"
					-annotation `getRunTimeCommandAnnotation("ShowMeshSprayToolOptions")`
					-enableCommandRepeat false 
					-command    "ShowMeshSprayToolOptions" ;

				$label = (uiRes("m_PolygonsBuildToolsMenu.kRepeatTool"));
				menuItem
					-label      $label
					-annotation `getRunTimeCommandAnnotation("SetMeshRepeatTool")`
					-image     "Repeat.png"
					-command    ("SetMeshRepeatTool")
					-dragDoubleClickCommand ("ShowMeshRepeatToolOptions");

				menuItem -optionBox 1 
					-image     "Repeat.png"
					-annotation `getRunTimeCommandAnnotation("ShowMeshRepeatToolOptions")`
					-enableCommandRepeat false 
					-command    "ShowMeshRepeatToolOptions" ;

				$label = (uiRes("m_PolygonsBuildToolsMenu.kImprintTool"));
				menuItem
					-label      $label
					-annotation `getRunTimeCommandAnnotation("SetMeshImprintTool")`
					-image     "Imprint.png"
					-command    ("SetMeshImprintTool")
					-dragDoubleClickCommand ("ShowMeshImprintToolOptions");

				menuItem -optionBox 1 
					-image     "Imprint.png"
					-annotation `getRunTimeCommandAnnotation("ShowMeshImprintToolOptions")`
					-enableCommandRepeat false 
					-command    "ShowMeshImprintToolOptions" ;

				$label = (uiRes("m_PolygonsBuildToolsMenu.kWaxTool"));
				menuItem
					-label      $label
					-annotation `getRunTimeCommandAnnotation("SetMeshWaxTool")`
					-image     "Wax.png"
					-command    ("SetMeshWaxTool")
					-dragDoubleClickCommand ("ShowMeshWaxToolOptions");

				menuItem -optionBox 1 
					-image     "Wax.png"
					-annotation `getRunTimeCommandAnnotation("ShowMeshWaxToolOptions")`
					-enableCommandRepeat false 
					-command    "ShowMeshWaxToolOptions" ;

				$label = (uiRes("m_PolygonsBuildToolsMenu.kScrapeTool"));
				menuItem
					-label      $label
					-annotation `getRunTimeCommandAnnotation("SetMeshScrapeTool")`
					-image     "Scrape.png"
					-command    ("SetMeshScrapeTool")
					-dragDoubleClickCommand ("ShowMeshScrapeToolOptions");

				menuItem -optionBox 1 
					-image     "Scrape.png"
					-annotation `getRunTimeCommandAnnotation("ShowMeshScrapeToolOptions")`
					-enableCommandRepeat false 
					-command    "ShowMeshScrapeToolOptions" ;

				$label = (uiRes("m_PolygonsBuildToolsMenu.kFillTool"));
				menuItem
					-label      $label
					-annotation `getRunTimeCommandAnnotation("SetMeshFillTool")`
					-image     "Fill.png"
					-command    ("SetMeshFillTool")
					-dragDoubleClickCommand ("ShowMeshFillToolOptions");

				menuItem -optionBox 1 
					-image     "Fill.png"
					-annotation `getRunTimeCommandAnnotation("ShowMeshFillToolOptions")`
					-enableCommandRepeat false 
					-command    "ShowMeshFillToolOptions" ;

				$label = (uiRes("m_PolygonsBuildToolsMenu.kKnifeTool"));
				menuItem
					-label      $label
					-annotation `getRunTimeCommandAnnotation("SetMeshKnifeTool")`
					-image     "Knife.png"
					-command    ("SetMeshKnifeTool")
					-dragDoubleClickCommand ("ShowMeshKnifeToolOptions");

				menuItem -optionBox 1 
					-image     "Knife.png"
					-annotation `getRunTimeCommandAnnotation("ShowMeshKnifeToolOptions")`
					-enableCommandRepeat false 
					-command    "ShowMeshKnifeToolOptions" ;

				$label = (uiRes("m_PolygonsBuildToolsMenu.kSmearTool"));
				menuItem
					-label      $label
					-annotation `getRunTimeCommandAnnotation("SetMeshSmearTool")`
					-image     "Smear.png"
					-command    ("SetMeshSmearTool")
					-dragDoubleClickCommand ("ShowMeshSmearToolOptions");

				menuItem -optionBox 1 
					-image     "Smear.png"
					-annotation `getRunTimeCommandAnnotation("ShowMeshSmearToolOptions")`
					-enableCommandRepeat false 
					-command    "ShowMeshSmearToolOptions" ;

				$label = (uiRes("m_PolygonsBuildToolsMenu.kBulgeTool"));
				menuItem
					-label      $label
					-annotation `getRunTimeCommandAnnotation("SetMeshBulgeTool")`
					-image     "Bulge.png"
					-command    ("SetMeshBulgeTool")
					-dragDoubleClickCommand ("ShowMeshBulgeToolOptions");

				menuItem -optionBox 1 
					-image     "Bulge.png"
					-annotation `getRunTimeCommandAnnotation("ShowMeshBulgeToolOptions")`
					-enableCommandRepeat false 
					-command    "ShowMeshBulgeToolOptions" ;

				$label = (uiRes("m_PolygonsBuildToolsMenu.kAmplifyTool"));
				menuItem
					-label      $label
					-annotation `getRunTimeCommandAnnotation("SetMeshAmplifyTool")`
					-image     "Amplify.png"
					-command    ("SetMeshAmplifyTool")
					-dragDoubleClickCommand ("ShowMeshAmplifyToolOptions");

				menuItem -optionBox 1 
					-image     "Amplify.png"
					-annotation `getRunTimeCommandAnnotation("ShowMeshAmplifyToolOptions")`
					-enableCommandRepeat false 
					-command    "ShowMeshAmplifyToolOptions" ;

				$label = (uiRes("m_PolygonsBuildToolsMenu.kFreezeTool"));
				menuItem
					-label      $label
					-annotation `getRunTimeCommandAnnotation("SetMeshFreezeTool")`
					-image     "Freeze.png"
					-command    ("SetMeshFreezeTool")
					-dragDoubleClickCommand ("ShowMeshFreezeToolOptions");

				menuItem -optionBox 1 
					-image     "Freeze.png"
					-annotation `getRunTimeCommandAnnotation("ShowMeshFreezeToolOptions")`
					-enableCommandRepeat false 
					-command    "ShowMeshFreezeToolOptions" ;

			setParent -m ..;

			menuItem
				-label (uiRes("m_PolygonsBuildToolsMenu.kPolyBuildSlideEdgeTool1"))
				-annotation (getRunTimeCommandAnnotation("SlideEdgeTool"))
				-image "slideEdgeTool.png"
				-command "SlideEdgeTool"
				-dragDoubleClickCommand "SlideEdgeToolOptions"
				;

			menuItem -optionBox true
				-annotation (getRunTimeCommandAnnotation("SlideEdgeToolOptions"))
				-image "slideEdgeTool.png"
				-command "SlideEdgeToolOptions"
				;

			menuItem
				-label  (uiRes("m_PolygonsBuildToolsMenu.kMTKTargetWeldTool1"))
				-annotation (getRunTimeCommandAnnotation("MergeVertexTool"))
				-command "MergeVertexTool" 
				-dragDoubleClickCommand "MergeVertexToolOptions"
				-image "weld_NEX32.png" 
				MTKTargetWeldTool;

			menuItem
				-label (uiRes("m_PolygonsBuildToolsMenu.kMTKTargetWeldToolOptions"))
				-annotation (getRunTimeCommandAnnotation("MergeVertexToolOptions"))
				-command "MergeVertexToolOptions"
				-optionBox 1
				-image "weld_NEX32.png" 
				;

		MTsetToggleMenuItem;
		loadPlugin -addCallback("modelingToolkitLoadCallbackProc");
		unloadPlugin -addCallback("modelingToolkitLoadCallbackProc");
	}
}
