// Copyright (C) 1997-2014 Autodesk, Inc., and/or its licensors.
// All rights reserved.
//
// The coded instructions, statements, computer programs, and/or related
// material (collectively the "Data") in these files contain unpublished
// information proprietary to Autodesk, Inc. ("Autodesk") and/or its licensors,
// which is protected by U.S. and Canadian federal copyright law and by
// international treaties.
//
// The Data is provided for use exclusively by You. You have the right to use,
// modify, and incorporate this Data into other products for purposes authorized 
// by the Autodesk software license agreement, without fee.
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND. AUTODESK
// DOES NOT MAKE AND HEREBY DISCLAIMS ANY EXPRESS OR IMPLIED WARRANTIES
// INCLUDING, BUT NOT LIMITED TO, THE WARRANTIES OF NON-INFRINGEMENT,
// MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE, OR ARISING FROM A COURSE 
// OF DEALING, USAGE, OR TRADE PRACTICE. IN NO EVENT WILL AUTODESK AND/OR ITS
// LICENSORS BE LIABLE FOR ANY LOST REVENUES, DATA, OR PROFITS, OR SPECIAL,
// DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES, EVEN IF AUTODESK AND/OR ITS
// LICENSORS HAS BEEN ADVISED OF THE POSSIBILITY OR PROBABILITY OF SUCH DAMAGES.

//
//
//  Creation Date:  Nov 25 1998
// 
//  Description:
//      This procedure creates the help menu items.
//
//	Arguments:
//		$object - is the name of the panel or window.
//		$menuParent - is the parent window.
//

global proc doHelpMenuItems (string $object, string $menuParent) 
{
	global string $gMainHelpMenu;
	global int $gPatchNotesExistState = 0;	// 0 = not searched, 1 = found, 2 = does not exist

	int $numOfMenuItemsBefore;
	int $numOfMenuItemsAfter;
	string $menuName;
	
	// get the name of the help menu
	if ($menuParent == "MayaWindow") {
		$menuName = "MainHelpMenu";
	}else {
		$menuName = "HelpMenu";
	}


	string $troubleshootLocation;
	$troubleshootLocation = `getenv MAYA_LOCATION`;
	if(`about -mac`) {
		$troubleshootLocation += "/../../";
	} else {
		$troubleshootLocation += "/";
	}
	string $troubleshootURL;
	$troubleshootURL = "file://" + $troubleshootLocation;

	if ($menuParent == "MayaWindow") {
		menuItem -divider true -dividerLabel (uiRes("m_doHelpMenuItems.kHelpFind"));
	}
	
	// Search Menus
	//
	menuItem -label (uiRes("m_doHelpMenuItems.kSearchMayaMenu"))
		-annotation (uiRes("m_doHelpMenuItems.kFindMenuAnn"))
		-image (languageResourcePath("menuIconHelp.png"))
		-enableCommandRepeat false
		-command "findMenuItem";
			
	// Autodesk Help...
	//
	string $label = (uiRes("m_doHelpMenuItems.kMayaHelp"));
	string $annotation = (uiRes("m_doHelpMenuItems.kMayaHelpAnn"));
	menuItem -label $label
		-annotation $annotation
		-image (languageResourcePath("menuIconHelp.png"))
		-enableCommandRepeat false
		-command "Help";

	// What's New
	//
	string $whatsNewURL = (uiRes("m_doHelpMenuItems.kWhatsNewURL"));
	menuItem -label (uiRes("m_doHelpMenuItems.kWhatsNew")) -subMenu true;			

		menuItem -label (uiRes("m_doHelpMenuItems.kListWhatsNew"))
			-annotation (uiRes("m_doHelpMenuItems.kWhatsNewAnn"))
				-enableCommandRepeat false
			-command ( "showHelp -absolute \"" + $whatsNewURL + "\"" );

		menuItem -label (uiRes("m_doHelpMenuItems.kHighlightWhatsNew"))
			-version `about -f` -checkBox `whatsNewHighlight -q -highlightOn`
			-annotation (uiRes("m_doHelpMenuItems.kHighlightWhatsNewAnn"))
			-command ( "if(#1) { WhatsNewHighlightingOn; } else { WhatsNewHighlightingOff; }" ) highlightWhatsNewHelpMenuItem;
			menuItem -optionBox true
				-annotation (uiRes("m_doHelpMenuItems.kWhatsNewPrefsAnn"))
				-c "PreferencesWindow";

		setParent -menu ..;

	// Only add to the main window
	//
	if ($menuParent == "MayaWindow") {
		menuItem -divider true -dividerLabel (uiRes("m_doHelpMenuItems.kHelpLearn")); 

		string $startupMoviesURL = (uiRes("m_doHelpMenuItems.kStartupMoviesURL"));
		$annotation = (uiRes("m_doHelpMenuItems.kStartupMoviesAnn"));
		menuItem -label (uiRes("m_doHelpMenuItems.kStartupMovies"))
			-annotation $annotation
			-enableCommandRepeat false
			-command ( "showHelp -absolute \"" + $startupMoviesURL + "\"" );	

		// Learning Channel
		//
		string $theMayaLearningChannelURL = (uiRes("m_doHelpMenuItems.kTheMayaLearningChannelURL"));
		$label = (uiRes("m_doHelpMenuItems.kLearningChannel"));
		$annotation = (uiRes("m_doHelpMenuItems.kLearningChannelAnn"));
		menuItem -label $label
			-annotation $annotation
			-image (languageResourcePath("menuIconHelp.png"))
			-enableCommandRepeat false
			-command ( "showHelp -absolute \"" + $theMayaLearningChannelURL + "\"" );

		// Tutorials
		//
        $label = (uiRes("m_doHelpMenuItems.kHelpTutorials"));
		menuItem -label $label -sm true;

		if ( `about -evalVersion` ) {
			menuItem -label (uiRes("m_doHelpMenuItems.kEvalTutorials"))
				-annotation (uiRes("m_doHelpMenuItems.kEvalTutorialsAnn"))
				-enableCommandRepeat false
				-command "showHelp DocsTutorialsPle";
		}
		else {
			string $tutorialURL = (uiRes("m_doHelpMenuItems.kTutorialURL"));
            $label = (uiRes("m_doHelpMenuItems.kTutorials"));
			$annotation = (uiRes("m_doHelpMenuItems.kTutorialsAnn"));
			menuItem -label $label
				-annotation $annotation
				-enableCommandRepeat false
				-command ( "showHelp -absolute \"" + $tutorialURL + "\"" );			
		}

		string $tutorialTrialsURL = (uiRes("m_doHelpMenuItems.kTutorialTrialsURL"));
		$annotation = (uiRes("m_doHelpMenuItems.kTutorialsTrialsAnn"));
		menuItem -label (uiRes("m_doHelpMenuItems.kTutorialsTrials"))
			-annotation $annotation
			-enableCommandRepeat false
			-command ( "showHelp -absolute \"" + $tutorialTrialsURL + "\"" );		
		setParent -m ..;

		menuItem -divider true -dividerLabel (uiRes("m_doHelpMenuItems.kHelpAdvance"));

		// Learning Path
		//
		string $extraLearningURL = (uiRes("m_doHelpMenuItems.kExtraLearningURL"));
		menuItem -label (uiRes("m_doHelpMenuItems.kExtraLearningRes"))
			-annotation (uiRes("m_doHelpMenuItems.kExtraLearningResAnn"))
			-enableCommandRepeat false
			-command ( "showHelp -absolute \"" + $extraLearningURL + "\"" );

		// Scripting Reference submenu
		//
        $label = (uiRes("m_doHelpMenuItems.kAdditionalHelp"));
		menuItem -label $label -sm true;

			menuItem -label (uiRes("m_doHelpMenuItems.kMELCommandRef"))
					-annotation (uiRes("m_doHelpMenuItems.kMELCommandRefAnn"))
					-image (languageResourcePath("menuIconHelp.png"))
					-enableCommandRepeat false
					-command "showHelp DocsMelCommands";

			if (`exists python`) {
				menuItem -label (uiRes("m_doHelpMenuItems.kPythonCommandRef"))
					-annotation (uiRes("m_doHelpMenuItems.kPythonCommandRefAnn"))
					-image (languageResourcePath("menuIconHelp.png"))
					-enableCommandRepeat false
					-command "showHelp DocsPythonCommands";
			}

			menuItem -label (uiRes("m_doHelpMenuItems.kNodeAttrRef"))
				-annotation (uiRes("m_doHelpMenuItems.kNodeAttrRefAnn"))
				-image (languageResourcePath("menuIconHelp.png"))
				-enableCommandRepeat false
				-command "showHelp DocsNodes";

			setParent -m ..;
		
		// Communities sub menu
		//
		$label =  (uiRes("m_doHelpMenuItems.kMayaCommunities"));
		menuItem -label $label -subMenu true;
			// AREA Product Community
			//
			string $theAreaURL = (uiRes("m_doHelpMenuItems.kTheAreaURL"));
			menuItem -label (uiRes("m_doHelpMenuItems.kTheArea")) 
				-annotation (uiRes("m_doHelpMenuItems.kTheAreaAnn"))
				-image (languageResourcePath("menuIconHelp.png"))
				-enableCommandRepeat false
				-command ( "showHelp -absolute \"" + $theAreaURL + "\"" );

			// AREA Discussion Forum
			//
			string $theAreaForumURL = (uiRes("m_doHelpMenuItems.kTheAreaForumURL"));
			menuItem -label (uiRes("m_doHelpMenuItems.kTheAreaForum")) 
				-annotation (uiRes("m_doHelpMenuItems.kTheAreaForumAnn"))
				-image (languageResourcePath("menuIconHelp.png"))
				-enableCommandRepeat false
				-command ( "showHelp -absolute \"" + $theAreaForumURL + "\"" );

			// Facebook
			//
			string $facebookURL = (uiRes("m_doHelpMenuItems.kFacebookURL"));
			$annotation = (uiRes("m_doHelpMenuItems.kFacebookAnn"));
			menuItem -label (uiRes("m_doHelpMenuItems.kFacebook")) 
				-annotation $annotation
				-image (languageResourcePath("menuIconHelp.png"))
				-enableCommandRepeat false
				-command ( "showHelp -absolute \"" + $facebookURL + "\"" );
			setParent -menu ..;
		
	// Maya Resources and Tools submenu
	//
	menuItem -label (uiRes("m_doHelpMenuItems.kMayaResourcesAndTools")) -subMenu true;
		// Autodesk DirectConnect Help
		//
		if((`about -windows` || `about -mac`) && !`about -evalVersion`) {
				
			string $directConnectHelpURL, $commandString;
			if(`about -windows`) {
				$directConnectHelpURL = `directConnectPath` + "docs/index.html";
			} else if (`about -mac`) {
				$directConnectHelpURL = "/Library/Application Support/Autodesk/DirectConnect/6.0/docs/index.html";
			}
				
			if(`file -query -exists $directConnectHelpURL`) {
				$commandString = "showHelp -absolute (\"file://" + $directConnectHelpURL + "\") ";
			} else {
				$commandString = "warning(\"" + (uiRes("m_doHelpMenuItems.kDirectConnectHelpNotFound")) + "\");showHelp -a \"http://www.autodesk.com/maya-directconnect\"";
			}
				
			menuItem -label (uiRes("m_doHelpMenuItems.kDirectConnect"))
					-annotation (uiRes("m_doHelpMenuItems.kDirectConnectAnn"))
					-enableCommandRepeat false
					-command $commandString;
		}

		menuItem -label (uiRes("m_doHelpMenuItems.kBrowserSetupAssistant"))
			-annotation (uiRes("m_doHelpMenuItems.kBrowserSetupAssistantAnn"))
			-image (languageResourcePath("menuIconHelp.png"))
			-enableCommandRepeat false
			-command "BrowserSetupAssistant()";

		string $downloadBonusToolsURL = (uiRes("m_doHelpMenuItems.kDownloadBonusToolsURL"));
		menuItem -label (uiRes("m_doHelpMenuItems.kDownloadBonusTools")) 
			-annotation (uiRes("m_doHelpMenuItems.kDownloadBonusToolsAnn"))
			-image (languageResourcePath("menuIconHelp.png"))
			-enableCommandRepeat false
			-command ( "showHelp -absolute \"" + $downloadBonusToolsURL + "\"" );

		string $downloadVegetationURL = (uiRes("m_doHelpMenuItems.kDownloadVegetationURL"));
		menuItem -label (uiRes("m_doHelpMenuItems.kDownloadVegetation")) 
			-annotation (uiRes("m_doHelpMenuItems.kDownloadVegetationAnn"))
			-image "menuIconHelp.png"
			-enableCommandRepeat false
			-command ( "showHelp -absolute \"" + $downloadVegetationURL + "\"" );
		setParent -menu ..;

		menuItem -divider true -dividerLabel (uiRes("m_doHelpMenuItems.kHelpContribute"));
		
		// Services and Support sub menu
		//
		menuItem -label (uiRes("m_doHelpMenuItems.kServicesAndSupport")) -subMenu true;

			// Autodesk Account
			//
			string $autodeskAccountURL = (uiRes("m_doHelpMenuItems.kAutodeskAccountURL"));
			menuItem -label (uiRes("m_doHelpMenuItems.kAutodeskAccount"))
				-version 2016
				-annotation (uiRes("m_doHelpMenuItems.kAutodeskAccountAnn"))
				-enableCommandRepeat false
				-command ( "showHelp -absolute \"" + $autodeskAccountURL + "\"" );

			if ($gPatchNotesExistState == 0) {
				string $patch_notes;
				$patch_notes = $troubleshootLocation + "patch_notes.html";
				$gPatchNotesExistState = 2;	// does not exist
				if (`filetest -r $patch_notes`) {
					$gPatchNotesExistState = 1;	// found
				}
			}

			if ($gPatchNotesExistState == 1) {
				menuItem -label (uiRes("m_doHelpMenuItems.kPatchReleaseNotes"))
						-annotation (uiRes("m_doHelpMenuItems.kPatchReleaseNotesAnn"))
						-enableCommandRepeat false
						-command ("showHelp -absolute (\"" + $troubleshootURL + "patch_notes.html\") ");
			}

			// Release Notes Updates
			//
			if ( !`about -evalVersion` ) {
				string $releaseNotesURL = (uiRes("m_doHelpMenuItems.kReleaseNotesURL"));
				menuItem -label (uiRes("m_doHelpMenuItems.kOnlineRelNotes"))
					-annotation (uiRes("m_doHelpMenuItems.kOnlineRelNotesAnn"))
					-enableCommandRepeat false
					-command ( "showHelp -absolute \"" + $releaseNotesURL + "\"" );
			}
						
			// Support Center
			//
			string $supportMayaURL = (uiRes("m_doHelpMenuItems.kSupportMayaURL"));
			menuItem -label (uiRes("m_doHelpMenuItems.kSupportCenter"))
				-annotation (uiRes("m_doHelpMenuItems.kSupportCenterAnn"))
				-image (languageResourcePath("menuIconHelp.png"))
				-enableCommandRepeat false
				-command ( "showHelp -absolute \"" + $supportMayaURL + "\"" );			

			setParent -menu ..;

		if ( !`about -evalVersion` ) {
			// Speak Back sub menu
			//
			menuItem -label (uiRes("m_doHelpMenuItems.kSpeakBack")) -sm true;
				// Report a Problem...
				//
				string $reportAProblemURL = "http://www.autodesk.com/maya-bugreport";
				menuItem -label (uiRes("m_doHelpMenuItems.kReportAProblem"))
					-annotation (uiRes("m_doHelpMenuItems.kReportAProblemAnn"))
					-image (languageResourcePath("menuIconHelp.png"))
					-enableCommandRepeat false
					-command ( "showHelp -absolute \"" + $reportAProblemURL + "\"" );

				// Small Annoying Things to Fix...
				//
				string $smallAnnoyingThingsURL = (uiRes("m_doHelpMenuItems.kSmallAnnoyingThingsURL"));
				menuItem -label (uiRes("m_doHelpMenuItems.kSmallAnnoyingThings"))
					-annotation (uiRes("m_doHelpMenuItems.kSmallAnnoyingThingsAnn"))
					-image (languageResourcePath("menuIconHelp.png"))
					-enableCommandRepeat false
					-command ( "showHelp -absolute \"" + $smallAnnoyingThingsURL + "\"" );

				// Ideas...
				//
				string $featureIdeasURL = (uiRes("m_doHelpMenuItems.kFeatureIdeasURL"));
				string $featureIdeasLabel = (uiRes("m_doHelpMenuItems.kFeatureIdeasLabel"));
				menuItem -label $featureIdeasLabel
					-annotation (uiRes("m_doHelpMenuItems.kFeatureIdeasAnn"))
					-image (languageResourcePath("menuIconHelp.png"))
					-enableCommandRepeat false
					-command ( "showHelp -absolute \"" + $featureIdeasURL + "\"" );
				
				menuItem -label (uiRes("m_doHelpMenuItems.kDesktopAnalytics"))
					-annotation (uiRes("m_doHelpMenuItems.kDesktopAnalyticsAnn"))
					-image (languageResourcePath("menuIconHelp.png"))
					-enableCommandRepeat false
					-command "customerInvolvementProgram -desktopAnalytics";
				menuItem -label (uiRes("m_doHelpMenuItems.kCustomerInvolvementProgram"))
					-annotation (uiRes("m_doHelpMenuItems.kCustomerInvolvementProgramAnn"))
					-image (languageResourcePath("menuIconHelp.png"))
					-enableCommandRepeat false
					-command "customerInvolvementProgram";
				setParent -m ..;
		} 
        // We only need the divider if the following menu items are defined.
		menuItem -divider true -dividerLabel (uiRes("m_doHelpMenuItems.kHelpExpand"));

		string $mayaExchangeURL = (uiRes("m_doHelpMenuItems.kMayaExchangeURL"));
		menuItem -version 2014 -label (uiRes("m_doHelpMenuItems.kExchangeApps"))
			-annotation (uiRes("m_doHelpMenuItems.kExchangeAppsAnn"))
			-image (languageResourcePath("menuIconHelp.png"))
			-enableCommandRepeat false
			-command ( "showHelp -absolute \"" + $mayaExchangeURL + "\"" );	

		string $autodeskOnlineStoreURL = (uiRes("m_doHelpMenuItems.kAutodeskOnlineStoreURL"));
		menuItem -label (uiRes("m_doHelpMenuItems.kOnlineStore"))
			-annotation (uiRes("m_doHelpMenuItems.kOnlineStoreAnn"))
			-image (languageResourcePath("menuIconHelp.png"))
			-enableCommandRepeat false
			-command ( "showHelp -absolute \"" + $autodeskOnlineStoreURL + "\"" );
	} // if ($menuParent == "MayaWindow")
	else 
	{
		menuItem -divider true; 
	}
	//	Context sensitive menu Items relative to each window.
	//
	$numOfMenuItemsBefore = `menu -query -numberOfItems $menuName`;
	doContextHelpProc $object $menuParent;
	$numOfMenuItemsAfter = `menu -query -numberOfItems $menuName`;

	if ($numOfMenuItemsBefore != $numOfMenuItemsAfter)
	{
		menuItem -divider true; 
	}

	// This section has been shifted into Additional Help submenu for the main window
	//
	if( $menuParent != "MayaWindow" ) {
		menuItem -label (uiRes("m_doHelpMenuItems.kMELCommandRef2"))
			-annotation (uiRes("m_doHelpMenuItems.kMELCommandRefAnn2"))
			-image (languageResourcePath("menuIconHelp.png"))
			-enableCommandRepeat false
			-command "showHelp DocsMelCommands";


		if (`exists python`) {
			menuItem -label (uiRes("m_doHelpMenuItems.kPythonCommandRef2"))
				-annotation (uiRes("m_doHelpMenuItems.kPythonCommandRefAnn2"))
				-image (languageResourcePath("menuIconHelp.png"))
				-enableCommandRepeat false
				-command "showHelp DocsPythonCommands";
		}

		menuItem -label (uiRes("m_doHelpMenuItems.kNodeAttrRef2"))
			-annotation (uiRes("m_doHelpMenuItems.kNodeAttrRefAnn2"))
			-image (languageResourcePath("menuIconHelp.png"))
			-enableCommandRepeat false
			-command "showHelp DocsNodes";

		menuItem -divider true;
	}
	
	// Only add to the main window
	if (!`about -mac` && ($menuParent == "MayaWindow")) {
		menuItem -divider true -dividerLabel (uiRes("m_doHelpMenuItems.kHelpAbout"));
		
		// About
		//
		$label = (uiRes("m_doHelpMenuItems.kAboutMaya"));
		$annotation = (uiRes("m_doHelpMenuItems.kAboutMayaAnn"));
		if (`about -evalVersion`)
		{
			$label = (uiRes("m_doHelpMenuItems.kAboutMayaPLE"));
			$annotation = (uiRes("m_doHelpMenuItems.kAboutMayaPLEAnn"));
		}		
					
		menuItem -label $label
			-annotation $annotation
			-image (languageResourcePath("menuIconHelp.png"))
			-enableCommandRepeat false
			-command "ProductInformation";
	}

	// Home Page
	//
	string $mayaHomeURL = (uiRes("m_doHelpMenuItems.kMayaHomeURL"));
	$label = (uiRes("m_doHelpMenuItems.kMayaHome"));
	$annotation = (uiRes("m_doHelpMenuItems.kMayaHomeAnn"));
	menuItem -label $label
		-annotation $annotation
		-image (languageResourcePath("menuIconHelp.png"))
		-enableCommandRepeat false
		-command ( "showHelp -absolute \"" + $mayaHomeURL + "\"" );
        
	 if ($menuParent == "MayaWindow") {
		if ( `about -evalVersion` ) {
			menuItem -divider true;
			
			string $buyMayaCommand = "";
			string $buyMayaURL  = (uiRes("m_doHelpMenuItems.kBuyMayaURL")); 
			$buyMayaCommand = "showHelp -absolute \"" + $buyMayaURL + "\"";
			
			menuItem -label (uiRes("m_doHelpMenuItems.kBuyMaya"))
				-annotation (uiRes("m_doHelpMenuItems.kBuyMayaAnn"))
				-enableCommandRepeat false
				-command $buyMayaCommand;

			string $pleOnTheWebURL = (uiRes("m_doHelpMenuItems.kPLEOnTheWebURL"));
			menuItem -label (uiRes("m_doHelpMenuItems.kPLEOnTheWeb"))
				-annotation (uiRes("m_doHelpMenuItems.kPLEOnTheWebAnn"))
				-image (languageResourcePath("menuIconHelp.png"))
				-enableCommandRepeat false
				-command ( "showHelp -absolute \"" + $pleOnTheWebURL + "\"" );
		}
	}
}

global proc updateHelpMenuItems(string $menuParent)
{
	// Update main window help items
	//
	if ($menuParent == "MayaWindow") {
		menuItem -e -checkBox `whatsNewHighlight -q -highlightOn` highlightWhatsNewHelpMenuItem;
	}
}

