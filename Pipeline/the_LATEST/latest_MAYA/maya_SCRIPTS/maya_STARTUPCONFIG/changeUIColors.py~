from maya import cmds
from maya import mel
from maya import OpenMayaUI as omui 

from PySide.QtCore import * 
from PySide.QtGui import * 
from shiboken import wrapInstance 




def change_maya_ui_text(color='green'):
    omui.MQtUtil.mainWindow()    
    ptr = omui.MQtUtil.mainWindow()    
    widget = wrapInstance(long(ptr), QWidget)
    widget.setStyleSheet( 'color:%s;'%color )

mayaMenus = [ '$gMainFileMenu', '$gMainEditMenu', 
			  '$gMainSelectMenu', '$gMainModifyMenu', 
			  '$gMainDisplayMenu', '$gMainWindowMenu', 
			  '$gMainOptionsMenu', '$gMainCreateMenu',
			] 

def change_maya_menu_colors( menu, fontStyle='italic', 
                             fontWeight='bold'
                           ):
    widgetStr = mel.eval( 'string $tempString = {0}'.format(menu) )    
    ptr = omui.MQtUtil.findControl( widgetStr )    
    widget = wrapInstance(long(ptr), QWidget)
    widget.setStyleSheet(
        'font-style:%s;'%fontStyle +
        'font-weight:%s;'%fontWeight
        )

change_maya_ui_text( color='rgb(68,210,68)' )
for menu in mayaMenus:
	change_maya_menu_colors( menu=menu, fontStyle='italic', 
                             fontWeight='bold' 
                            )
