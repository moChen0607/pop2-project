




<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>VSFX 312 - Menger Fractal &mdash; Portal: Origins [Part 2] 1.0.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
  

  
    <link rel="top" title="Portal: Origins [Part 2] 1.0.0 documentation" href="../index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Portal: Origins [Part 2]
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../wip/index.html">Portal Origins Part 2</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../pickrunner/pickrunner.html">Pickrunner</a></li>
<li class="toctree-l1"><a class="reference internal" href="../abs2rel/abs2rel.html">Batch Absolute Files to Relative Paths</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hdrprocess/hdrprocess.html">HDRi Batch Processor</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Portal: Origins [Part 2]</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>VSFX 312 - Menger Fractal</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/tech_312/menger.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="vsfx-312-menger-fractal">
<h1>VSFX 312 - Menger Fractal<a class="headerlink" href="#vsfx-312-menger-fractal" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<ul class="simple">
</ul>
</div>
<img alt="../_images/menger_city_full.jpeg" class="align-center" src="../_images/menger_city_full.jpeg" />
<div class="section" id="project-definition">
<h2>Project Definition<a class="headerlink" href="#project-definition" title="Permalink to this headline">¶</a></h2>
<p>The menger fractal is constructed by subdividing a single cube X number of
times, while randomly deleting specific inner parts of the cube. Menger
fractals exist in 2D and 3D variants as long as the math is adjusted
accordingly.</p>
<p>For full project documentation, see this link <a class="reference internal" href="mengerdocumentation.html"><em>Menger Full Documentation</em></a></p>
</div>
<div class="section" id="goals">
<h2>Goals<a class="headerlink" href="#goals" title="Permalink to this headline">¶</a></h2>
<p>Create a random menger city automatically, with quick iterations between
versions.</p>
<img alt="../_images/menger_stepped_highQ.jpg" class="align-center" src="../_images/menger_stepped_highQ.jpg" />
<p>Here I was experimenting with isolating patches of the menger fractal. Given
certain section numbers, the menger fractal can be controlled before subdivision
occurs</p>
<img alt="../_images/menger_eagle_highQ.jpg" class="align-center" src="../_images/menger_eagle_highQ.jpg" />
<p>Testing out a sine wave through the menger fractal</p>
<img alt="../_images/menger_2SPOT5D_highQ.jpg" class="align-center" src="../_images/menger_2SPOT5D_highQ.jpg" />
<p>When a the 4th vertex is pulled down, it makes a 2d menger fractal stretch with
a jagged look which is not unlike it&#8217;s full 3D counterpart (see below)</p>
</div>
<div class="section" id="automatic-city-generation">
<h2>Automatic City Generation<a class="headerlink" href="#automatic-city-generation" title="Permalink to this headline">¶</a></h2>
<object width="480" height="385"><param name="movie"
value="_images/menger_city_generation.mp4"></param><param
name="allowFullScreen" value="true"></param><param
name="allowscriptaccess" value="always"></param><embed
src="_images/menger_city_generation.mp4"
allowscriptaccess="always"
allowfullscreen="true" width="700"
height="385"></embed></object>
</br></br><dl class="docutils">
<dt>Creating a field of menger cubes works like so:</dt>
<dd><ul class="first last">
<li><dl class="first docutils">
<dt>create a field of cubes in the X and Z direction</dt>
<dd><ul class="first last simple">
<li>get the object-space bounding box and use that as a step
(so that no cube intersect another) + user defined spacing</li>
<li>Expand the cubes upwards in the Y direction for height</li>
<li>initialize menger-related attributes for cube</li>
<li>randomize the values of the attributes,
within given user constraints</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">get the current scene name, move up to the project directory and
navigate to the data folder and place files there</p>
<blockquote>
<div><ul class="simple">
<li>the file name is automatically generated using the scene
name, the full dag path of the given</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">simulate the rib files for every cube (for one or multiple frames)</p>
</li>
<li><p class="first">render the menger</p>
</li>
</ul>
</dd>
</dl>
<p>Which, altogether, lets the user create some really fast, rapid prototyping
of different scenes. It also has the added bonus of scaling with the size</p>
<p>of a given scene input and could be extended to follow the normal of a ground
plane with very little additional effort.</p>
<pre style='color:#000000;background:#ffffff;'><span style='color:#800000; font-weight:bold; '>def</span> create_menger<span style='color:#808030; '>(</span><span style='color:#400000; '>object</span><span style='color:#808030; '>)</span><span style='color:#808030; '>:</span>
    <span style='color:#696969; '>"""</span>
<span style='color:#696969; '>&#xa0;&#xa0;&#xa0;&#xa0;Creates the menger</span>
<span style='color:#696969; '></span>
<span style='color:#696969; '>&#xa0;&#xa0;&#xa0;&#xa0;.. important::</span>
<span style='color:#696969; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;This script communicates which rib file to render as the current shape </br> by using the variable outputPath</span>
<span style='color:#696969; '></span>
<span style='color:#696969; '>&#xa0;&#xa0;&#xa0;&#xa0;.. note::</span>
<span style='color:#696969; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;Currently, file frame padding has been hard-coded to 4. May need to add a variable for</span>
<span style='color:#696969; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;this in the future, if necessary</span>
<span style='color:#696969; '></span>
<span style='color:#696969; '>&#xa0;&#xa0;&#xa0;&#xa0;.. note::</span>
<span style='color:#696969; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;This function does not expect arguments but the following attributes must be</span>
<span style='color:#696969; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;passed through the maya object's shape node..</span>
<span style='color:#696969; '></span>
<span style='color:#696969; '>&#xa0;&#xa0;&#xa0;&#xa0;Args:</span>
<span style='color:#696969; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;object (&lt;pm.nodetypes.Mesh>): The object to create a menger from</span>
<span style='color:#696969; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;rootDir (str): The output path of the menger</span>
<span style='color:#696969; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;depth (int): The number of recursions created before the menger is drawn</span>
<span style='color:#696969; '></span>
<span style='color:#696969; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;.. note::</span>
<span style='color:#696969; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;freq will not have any effect if amp is 0</span>
<span style='color:#696969; '></span>
<span style='color:#696969; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;animation (bool): Enables/Disables writing/reading .rib files with</span>
<span style='color:#696969; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;frame numbers, which allows for deforming animation</span>
<span style='color:#696969; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;allowRibWrite (bool): Lets the user save by frame number</span>
<span style='color:#696969; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;holes (list): A list of integers to of which indices (1-27) to remove</span>
<span style='color:#696969; '></span>
<span style='color:#696969; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;Returns:</span>
<span style='color:#696969; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;str: The resulting (read) file path of the .rib file</span>
<span style='color:#696969; '>&#xa0;&#xa0;&#xa0;&#xa0;"""</span>
    shapeNode <span style='color:#808030; '>=</span> pm<span style='color:#808030; '>.</span>PyNode<span style='color:#808030; '>(</span><span style='color:#400000; '>object</span><span style='color:#808030; '>)</span>  <span style='color:#696969; '># cast to PyMEL object</span>
    <span style='color:#696969; '># check to make sure the user wants to write the rib</span>

    <span style='color:#696969; '># attrs = get_attributes(object)</span>
    depth <span style='color:#808030; '>=</span> pm<span style='color:#808030; '>.</span><span style='color:#400000; '>getAttr</span><span style='color:#808030; '>(</span><span style='color:#400000; '>object</span> <span style='color:#44aadd; '>+</span> <span style='color:#0000e6; '>'.depth'</span><span style='color:#808030; '>)</span>
    holes <span style='color:#808030; '>=</span> pm<span style='color:#808030; '>.</span><span style='color:#400000; '>getAttr</span><span style='color:#808030; '>(</span><span style='color:#400000; '>object</span> <span style='color:#44aadd; '>+</span> <span style='color:#0000e6; '>'.holes'</span><span style='color:#808030; '>)</span>
    renderStyle <span style='color:#808030; '>=</span> pm<span style='color:#808030; '>.</span><span style='color:#400000; '>getAttr</span><span style='color:#808030; '>(</span><span style='color:#400000; '>object</span> <span style='color:#44aadd; '>+</span> <span style='color:#0000e6; '>'.renderStyle'</span><span style='color:#808030; '>)</span>
    <span style='color:#800000; font-weight:bold; '>if</span> renderStyle <span style='color:#44aadd; '>==</span> <span style='color:#008c00; '>0</span><span style='color:#808030; '>:</span>
        renderStyle<span style='color:#808030; '>=</span><span style='color:#0000e6; '>"menger"</span>
    <span style='color:#800000; font-weight:bold; '>elif</span> renderStyle <span style='color:#44aadd; '>==</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>:</span>
        renderStyle <span style='color:#808030; '>=</span> <span style='color:#0000e6; '>"retained"</span>
    <span style='color:#800000; font-weight:bold; '>elif</span> renderStyle <span style='color:#44aadd; '>==</span> <span style='color:#008c00; '>2</span><span style='color:#808030; '>:</span>
        renderStyle <span style='color:#808030; '>=</span> <span style='color:#0000e6; '>"both"</span>

    enableWrite <span style='color:#808030; '>=</span> pm<span style='color:#808030; '>.</span><span style='color:#400000; '>getAttr</span><span style='color:#808030; '>(</span><span style='color:#400000; '>object</span> <span style='color:#44aadd; '>+</span> <span style='color:#0000e6; '>'.allowRibWrite'</span><span style='color:#808030; '>)</span>
    animation <span style='color:#808030; '>=</span> pm<span style='color:#808030; '>.</span><span style='color:#400000; '>getAttr</span><span style='color:#808030; '>(</span><span style='color:#400000; '>object</span> <span style='color:#44aadd; '>+</span> <span style='color:#0000e6; '>'.animation'</span><span style='color:#808030; '>)</span>

    <span style='color:#800000; font-weight:bold; '>global</span> OUTPUT_PATH
    fullPath <span style='color:#808030; '>=</span> cmds<span style='color:#808030; '>.</span><span style='color:#400000; '>file</span><span style='color:#808030; '>(</span>q<span style='color:#808030; '>=</span><span style='color:#074726; '>True</span><span style='color:#808030; '>,</span> sceneName<span style='color:#808030; '>=</span><span style='color:#074726; '>True</span><span style='color:#808030; '>)</span>
    OUTPUT_PATH <span style='color:#808030; '>=</span> fullPath
    <span style='color:#800000; font-weight:bold; '>if</span> animation<span style='color:#808030; '>:</span>
        OUTPUT_PATH <span style='color:#808030; '>=</span> get_output_path<span style='color:#808030; '>(</span>OUTPUT_PATH<span style='color:#808030; '>)</span>

    writePath <span style='color:#808030; '>=</span> os<span style='color:#808030; '>.</span>path<span style='color:#808030; '>.</span>join<span style='color:#808030; '>(</span><span style='color:#44aadd; '>*</span>os_path_split_asunder<span style='color:#808030; '>(</span>OUTPUT_PATH<span style='color:#808030; '>)</span><span style='color:#808030; '>[</span><span style='color:#808030; '>:</span><span style='color:#44aadd; '>-</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>]</span><span style='color:#808030; '>)</span>
    fileName <span style='color:#808030; '>=</span> os_path_split_asunder<span style='color:#808030; '>(</span>OUTPUT_PATH<span style='color:#808030; '>)</span><span style='color:#808030; '>[</span><span style='color:#44aadd; '>-</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>]</span>
    writePath <span style='color:#808030; '>=</span> os<span style='color:#808030; '>.</span>path<span style='color:#808030; '>.</span>join<span style='color:#808030; '>(</span>writePath<span style='color:#808030; '>,</span> <span style='color:#0000e6; '>"data"</span><span style='color:#808030; '>,</span> fileName<span style='color:#808030; '>)</span>
    pathShapeName <span style='color:#808030; '>=</span> shapeNode<span style='color:#808030; '>.</span>dagPath<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>replace<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"|"</span><span style='color:#808030; '>,</span> <span style='color:#0000e6; '>"_"</span><span style='color:#808030; '>)</span>
    writePath <span style='color:#808030; '>=</span> os<span style='color:#808030; '>.</span>path<span style='color:#808030; '>.</span>splitext<span style='color:#808030; '>(</span>writePath<span style='color:#808030; '>)</span><span style='color:#808030; '>[</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>]</span> <span style='color:#44aadd; '>+</span> <span style='color:#0000e6; '>"_{}.rib"</span><span style='color:#808030; '>.</span>format<span style='color:#808030; '>(</span>pathShapeName<span style='color:#808030; '>)</span>
    OUTPUT_PATH <span style='color:#808030; '>=</span> writePath

    <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#800000; font-weight:bold; '>not</span> enableWrite<span style='color:#808030; '>:</span>
        <span style='color:#800000; font-weight:bold; '>return</span>  OUTPUT_PATH

    <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#400000; '>isinstance</span><span style='color:#808030; '>(</span>shapeNode<span style='color:#808030; '>,</span> pm<span style='color:#808030; '>.</span>nodetypes<span style='color:#808030; '>.</span>Transform<span style='color:#808030; '>)</span><span style='color:#808030; '>:</span>
        transformNode <span style='color:#808030; '>=</span> shapeNode
        shapeNode <span style='color:#808030; '>=</span> shapeNode<span style='color:#808030; '>.</span>getShape<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span>
    <span style='color:#800000; font-weight:bold; '>else</span><span style='color:#808030; '>:</span>
        transformNode <span style='color:#808030; '>=</span> shapeNode<span style='color:#808030; '>.</span>getParent<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span>

    boundingBox <span style='color:#808030; '>=</span> transformNode<span style='color:#808030; '>.</span>getBoundingBoxInvisible<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span>
    boundingBox <span style='color:#808030; '>=</span> get_bounding_box_local<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span>
    <span style='color:#696969; '># bbMinX, bbMinY, bbMinZ, bbMaxX, bbMaxY, bbMaxZ = boundingBox</span>

    holes <span style='color:#808030; '>=</span> <span style='color:#808030; '>[</span><span style='color:#400000; '>int</span><span style='color:#808030; '>(</span>x<span style='color:#808030; '>.</span>strip<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#800000; font-weight:bold; '>for</span> x <span style='color:#800000; font-weight:bold; '>in</span> holes<span style='color:#808030; '>.</span>split<span style='color:#808030; '>(</span><span style='color:#0000e6; '>','</span><span style='color:#808030; '>)</span><span style='color:#808030; '>]</span>

    menger <span style='color:#808030; '>=</span> Menger3D<span style='color:#808030; '>(</span>boundingBox<span style='color:#808030; '>,</span> depth<span style='color:#808030; '>,</span> holes<span style='color:#808030; '>)</span>
    menger<span style='color:#808030; '>.</span>writeAsCubes<span style='color:#808030; '>(</span>OUTPUT_PATH<span style='color:#808030; '>,</span> cube_type<span style='color:#808030; '>=</span>renderStyle<span style='color:#808030; '>)</span>
    <span style='color:#800000; font-weight:bold; '>return</span> OUTPUT_PATH
<span style='color:#696969; '># end create_menger</span>
</pre></div>
<div class="section" id="code-links">
<h2>Code Links<a class="headerlink" href="#code-links" title="Permalink to this headline">¶</a></h2>
<p>All of the used files can be downloaded on my <a class="reference external" href="https://github.com/ColinKennedy/tech_312_menger_city">GitHub repo</a>.</p>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>I wish that I had more time to properly write this code to be just a single
rib file with various rib archive reads. I had a hard time battling Maya&#8217;s GUI,
which only supported roughly a few thousand cubes before my script started
experience serious slowdowns. Now that I have exposure to Maya&#8217;s OpenMaya
Python API 2.0, it&#8217;d be nice to also go back and make the more expensive calls
to various functions more efficient</p>
</div>
<div class="section" id="indices-and-tables">
<h2>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="../genindex.html"><span>Index</span></a></li>
<li><a class="reference internal" href="../py-modindex.html"><span>Module Index</span></a></li>
<li><a class="reference internal" href="../search.html"><span>Search Page</span></a></li>
</ul>
</div>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Colin Kennedy.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>