




<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>network.controller.network &mdash; Portal: Origins [Part 2] 1.0.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../../_static/style.css" type="text/css" />
  

  
    <link rel="top" title="Portal: Origins [Part 2] 1.0.0 documentation" href="../../../index.html"/>
        <link rel="up" title="Module code" href="../../index.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> Portal: Origins [Part 2]
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../wip/index.html">Portal Origins Part 2</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../pickrunner/pickrunner.html">Pickrunner</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../abs2rel/abs2rel.html">Batch Absolute Files to Relative Paths</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../hdrprocess/hdrprocess.html">HDRi Batch Processor</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../index.html">Portal: Origins [Part 2]</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../index.html">Module code</a> &raquo;</li>
      
    <li>network.controller.network</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for network.controller.network</h1><div class="highlight"><pre>
<span class="ch">#!/usr/bin/python</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">.. Project::</span>
<span class="sd"> Portal Origins: Part Two</span>

<span class="sd">.. Description::</span>
<span class="sd"> Network module handles requests and changing information about the user and</span>
<span class="sd"> their access to the current network.</span>

<span class="sd"> Note, this file is not meant to be executed directly</span>

<span class="sd">.. Author::</span>
<span class="sd"> Colin Kennedy</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># IMPORT STANDARD LIBRARIES</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">socket</span>  <span class="c1"># for determining user&#39;s network location</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">getpass</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># IMPORT LOCAL LIBRARIES</span>
<span class="kn">from</span> <span class="nn">constants.model</span> <span class="kn">import</span> <span class="n">constants</span> <span class="k">as</span> <span class="n">consts</span>
<span class="kn">import</span> <span class="nn">logger.common.loggingServices</span> <span class="kn">as</span> <span class="nn">loggingservices</span>
<span class="n">LOGGER</span> <span class="o">=</span> <span class="n">loggingservices</span><span class="o">.</span><span class="n">init_logger</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">fileio.controller</span> <span class="kn">import</span> <span class="n">omnibus</span>


<div class="viewcode-block" id="NetworkManager"><a class="viewcode-back" href="../../../wip/network.html#network.controller.network.NetworkManager">[docs]</a><span class="k">class</span> <span class="nc">NetworkManager</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The main interfacing class that is used to communicate over the network</span>
<span class="sd">    between projects/files/applications. It partially leverages the checkout</span>
<span class="sd">    module (See :ref:`checkout`) for general file I/O but extends upon it</span>
<span class="sd">    to make sure that files are OK and not locked/hidden/unsaveable/corrupted/etc</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Locked name does not necessarily exist but is the convention for</span>
<span class="sd">        all locked file names.</span>

<span class="sd">        Required Contact Info</span>
<span class="sd">        ---------------------</span>
<span class="sd">         - MACHINE</span>
<span class="sd">         - IP</span>
<span class="sd">         - USERNAME</span>
<span class="sd">         - USERFULLNAME</span>
<span class="sd">         - EMAIL</span>
<span class="sd">         - PHONENUMBER</span>
<span class="sd">         - ROOM</span>
<span class="sd">         - TIME</span>
<span class="sd">         - DATE</span>

<span class="sd">        User info is stored under self.contactInfo</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">NetworkManager</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">contactInfo</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_file</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_locked</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lockedFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span> <span class="o">+</span> <span class="n">consts</span><span class="o">.</span><span class="n">LOCKED_NOTIFIER</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_local</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_locked</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_has_access</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_crewListWks</span> <span class="o">=</span> <span class="s1">&#39;Crew_spreadsheet_dup_test&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_requiredContactInfo</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;MACHINE&#39;</span><span class="p">,</span> <span class="s1">&#39;IP&#39;</span><span class="p">,</span> <span class="s1">&#39;USERNAME&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;USERFULLNAME&#39;</span><span class="p">,</span> <span class="s1">&#39;EMAIL&#39;</span><span class="p">,</span> <span class="s1">&#39;PHONENUMBER&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;ROOM&#39;</span><span class="p">,</span> <span class="s1">&#39;TIME&#39;</span><span class="p">,</span> <span class="s1">&#39;DATE&#39;</span><span class="p">]</span>
    <span class="c1"># end __init__</span>

    <span class="c1"># def request_access(self):</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     Looks at file&#39;s name to get the username of the person.</span>
    <span class="c1">#     Sends that person an e-mail, requesting access to the file</span>

    <span class="c1">#     .. TODO::</span>
    <span class="c1">#      Possibly integrate this with slack - so that people can get a message</span>
    <span class="c1">#      instead of an e-mail</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     pass</span>
    <span class="c1"># # end request_access</span>

    <span class="c1"># def set_contact_info(self, *args, **kwargs):</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     Sets the contact information on the locked file being queried.</span>
    <span class="c1">#     Creates a locked file if none exists</span>

    <span class="c1">#     .. Note::</span>
    <span class="c1">#      DEPRECATED in favor of :ref:`collect_contact_info`</span>

    <span class="c1">#     :returns: Whether or not the set was successful, True/False</span>
    <span class="c1">#     :rtype: bool</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     if self._file is None:</span>
    <span class="c1">#         LOGGER.error([&quot;AIE7602&quot;])</span>
    <span class="c1">#         return None</span>
    <span class="c1">#     pass  # ::TO DO:: append to the contact info variable (so that it can be queried)</span>
    <span class="c1"># # end set_contact_info</span>

<div class="viewcode-block" id="NetworkManager.is_local"><a class="viewcode-back" href="../../../wip/network.html#network.controller.network.NetworkManager.is_local">[docs]</a>    <span class="k">def</span> <span class="nf">is_local</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Used to determine if a user is accessing a file from the local space</span>
<span class="sd">        or from over the network collaborative space using self.file</span>

<span class="sd">        .. Considerations::</span>
<span class="sd">         This method is semi-unintelligent</span>

<span class="sd">        .. AUTHORNOTE::</span>
<span class="sd">         Change with environment variables in the future and account for </span>
<span class="sd">	 different OSes</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True/False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="s2">&quot;COLLABORATIVE&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">upper</span><span class="p">():</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">([</span><span class="s1">&#39;AIE4606&#39;</span><span class="p">,</span> <span class="s1">&#39;match_false&#39;</span><span class="p">],</span> <span class="p">{</span><span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="p">})</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">([</span><span class="s1">&#39;AIE4607&#39;</span><span class="p">,</span> <span class="s1">&#39;match_true&#39;</span><span class="p">],</span> <span class="p">{</span><span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="p">})</span>
            <span class="k">return</span> <span class="bp">False</span></div>
    <span class="c1"># end is_local</span>

<div class="viewcode-block" id="NetworkManager.is_remote"><a class="viewcode-back" href="../../../wip/network.html#network.controller.network.NetworkManager.is_remote">[docs]</a>    <span class="k">def</span> <span class="nf">is_remote</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine if user is working remotely from home by finding out if</span>
<span class="sd">        they&#39;re hardwired to the SCAD network by looking up consts.IPADDRESS</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True/False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># if socket.gethostbyname(socket.gethostname()).startswith(&#39;10.7&#39;):</span>
        <span class="k">if</span> <span class="n">consts</span><span class="o">.</span><span class="n">IPADDRESS</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;10.7&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span></div>
    <span class="c1"># end is_remote</span>

    <span class="c1"># def get_network_path_from_relative(self):</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     Uses a local path and tries to find an exact match over the network</span>
    <span class="c1">#     for the same paths/files (if it exists)</span>

    <span class="c1">#     .. TODO::</span>
    <span class="c1">#      Implement this after getting features for getting the latest file have</span>
    <span class="c1">#      been implemented</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     pass</span>
    <span class="c1"># # end get_network_path_from_relative</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">locked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Locks the current file with a self.lockedName with</span>
<span class="sd">        information about the current user inside of the locked file</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether or not the file is locked, True/False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_locked</span>
    <span class="c1"># end locked.property</span>

    <span class="nd">@locked.setter</span>
    <span class="k">def</span> <span class="nf">locked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">status</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set method for locking or unlocking a specified file over the network</span>

<span class="sd">        Setting the locked method to true will generate a locked file version</span>
<span class="sd">        Setting the locked method to false will delete the locked file version</span>

<span class="sd">        .. TODO::</span>
<span class="sd">         Add a lock method to the current property</span>

<span class="sd">        Args:</span>
<span class="sd">            status (bool): The new state for file in self.file, True/False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_locked</span> <span class="o">=</span> <span class="n">status</span>  <span class="c1"># regardless of network condition, set the state</span>

        <span class="c1"># test for locked file types and set/delete data if necessary</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_locked</span> <span class="o">==</span> <span class="bp">True</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">locked_file</span><span class="p">):</span>
            <span class="c1"># userContactInfo = project_member_contact_info(wks=self._crewListWks)  # DEPRECATED - See Note 66</span>
            <span class="c1"># userContactInfo = project_member_contact_info()</span>
            <span class="n">userContactInfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect_contact_info</span><span class="p">()</span>
            <span class="c1"># LOGGER.info(&quot;This is what will go in the file&quot;)</span>
            <span class="c1"># LOGGER.info(str(userContactInfo))</span>
            <span class="c1"># LOGGER.info(str(type(userContactInfo)))</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">locked_file</span><span class="p">)):</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">locked_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">userContactInfo</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">LOGGER</span><span class="o">.</span><span class="n">critical</span><span class="p">([</span><span class="s1">&#39;AIE9606&#39;</span><span class="p">,</span> <span class="s1">&#39;match_false&#39;</span><span class="p">],</span>
                                <span class="p">{</span><span class="s1">&#39;folder&#39;</span><span class="p">:</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">locked_file</span><span class="p">),</span>
                                 <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;Write user data to a locked version of file/folder&quot;</span><span class="p">})</span>



        <span class="k">elif</span> <span class="n">status</span> <span class="o">==</span> <span class="bp">False</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">locked_file</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">locked_file</span><span class="p">)</span>
    <span class="c1"># end locked.setter</span>
    <span class="c1"># end locked</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_locked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given a file path, determine if the locked version of the file</span>
<span class="sd">        exists in the same directory</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether or not the given file is locked, True/False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_locked</span>
    <span class="c1"># end @is_locked.property</span>

    <span class="nd">@is_locked.setter</span>
    <span class="k">def</span> <span class="nf">is_locked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Setter method for is_locked</span>
<span class="sd">        Admittedly, this setter method is pointless because whatever value</span>
<span class="sd">        the user sets will be overwritten based on whether or not the file</span>
<span class="sd">        actually exists on the local machine.</span>

<span class="sd">        .. TODO::</span>
<span class="sd">         Maybe have this file generate lock files when it&#39;s set to True/False</span>

<span class="sd">        Args:</span>
<span class="sd">            value (bool): The value to set the current lock state of a file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_locked</span> <span class="o">=</span> <span class="n">value</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_lockedFile</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_is_locked</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_is_locked</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="c1"># end is_locked.setter</span>
    <span class="c1"># end is_locked</span>

<div class="viewcode-block" id="NetworkManager.is_admin"><a class="viewcode-back" href="../../../wip/network.html#network.controller.network.NetworkManager.is_admin">[docs]</a>    <span class="k">def</span> <span class="nf">is_admin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if the current user is a registered admin for the current project</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True/False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">consts</span><span class="o">.</span><span class="n">USERNAME</span> <span class="ow">in</span> <span class="n">consts</span><span class="o">.</span><span class="n">REGISTERED_ADMINS</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span></div>
    <span class="c1"># end is_admin</span>

<div class="viewcode-block" id="NetworkManager.has_access"><a class="viewcode-back" href="../../../wip/network.html#network.controller.network.NetworkManager.has_access">[docs]</a>    <span class="k">def</span> <span class="nf">has_access</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to determine if a specific user has access to a given file.</span>

<span class="sd">        Default behavior is to assume the user has no access and then grant it.</span>
<span class="sd">        Uses self.locked_file to check if a locked file exists</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True/False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_has_access</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="c1"># contactInfo = project_member_contact_info()</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">locked_file</span><span class="p">):</span>
            <span class="n">contactInfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_contact_info_from_locked_file</span><span class="p">()</span>
            <span class="c1"># if contactInfo is not None:</span>
            <span class="c1">#     LOGGER.info(&quot;TEST: contactInfo is not None&quot;)</span>
            <span class="c1"># if &quot;USERNAME&quot; in contactInfo:</span>
            <span class="c1">#     LOGGER.info(&quot;TEST: USERNAME is in the contactINfo&quot;)</span>
            <span class="c1"># if contactInfo[&#39;USERNAME&#39;] == consts.USERNAME:</span>
            <span class="c1">#     LOGGER.info(&quot;TEST: contactInfo[&#39;USERNAME&#39;] is the active user&quot;)</span>
            <span class="c1"># if consts.USERNAME in consts.REGISTERED_ADMINS:</span>
            <span class="c1">#     LOGGER.info(&quot;TEST: consts.USERNAME in consts.REGISTERED_ADMINS&quot;)</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">contactInfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="s2">&quot;USERNAME&quot;</span> <span class="ow">in</span> <span class="n">contactInfo</span> \
                    <span class="ow">and</span> <span class="n">contactInfo</span><span class="p">[</span><span class="s1">&#39;USERNAME&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">consts</span><span class="o">.</span><span class="n">USERNAME</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_admin</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_has_access</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_has_access</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_has_access</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_access</span></div>
    <span class="c1"># end has_access</span>

<div class="viewcode-block" id="NetworkManager.read_contact_info_from_locked_file"><a class="viewcode-back" href="../../../wip/network.html#network.controller.network.NetworkManager.read_contact_info_from_locked_file">[docs]</a>    <span class="k">def</span> <span class="nf">read_contact_info_from_locked_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads information from the locked file and returns it using</span>
<span class="sd">        self.locked_file</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict or NoneType: Gets the contact info as a dictionary from the</span>
<span class="sd">                              locked file as a JSON dict or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">locked_file</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">None</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">locked_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">contactDict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="c1"># LOGGER.info(&quot;json load: &quot; + str(contactDict))</span>
        <span class="n">outputDict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">cred</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_requiredContactInfo</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cred</span> <span class="ow">in</span> <span class="n">contactDict</span><span class="p">:</span>
                <span class="n">outputDict</span><span class="p">[</span><span class="n">cred</span><span class="p">]</span> <span class="o">=</span> <span class="n">contactDict</span><span class="p">[</span><span class="n">cred</span><span class="p">]</span>
        <span class="c1"># LOGGER.info(&quot;final outputDict: &quot; + str(outputDict))</span>
        <span class="k">return</span> <span class="n">outputDict</span></div>
    <span class="c1"># end read_contact_info_from_locked_file</span>

<div class="viewcode-block" id="NetworkManager.is_incomplete_read_contact_info"><a class="viewcode-back" href="../../../wip/network.html#network.controller.network.NetworkManager.is_incomplete_read_contact_info">[docs]</a>    <span class="k">def</span> <span class="nf">is_incomplete_read_contact_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dictH</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A check to make sure that the contact info that</span>
<span class="sd">        was read and received with incomplete info.</span>

<span class="sd">        Args:</span>
<span class="sd">            dictH (dict): The contact info dict. If nont is specified, the dict</span>
<span class="sd">                          is read and parsed from self.locked_file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True/False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">contactDict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">dictH</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">contactDict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_contact_info_from_locked_file</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">contactDict</span> <span class="o">=</span> <span class="n">dictH</span>
        <span class="c1"># LOGGER.info(&quot;is_incomplet: contact dict from read: &quot; + str(contactDict))</span>

        <span class="k">for</span> <span class="n">cred</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_requiredContactInfo</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cred</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">contactDict</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span></div>
    <span class="c1"># end is_incomplete_read_contact_info</span>

<div class="viewcode-block" id="NetworkManager.collect_contact_info"><a class="viewcode-back" href="../../../wip/network.html#network.controller.network.NetworkManager.collect_contact_info">[docs]</a>    <span class="k">def</span> <span class="nf">collect_contact_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates contact information from the current user.</span>
<span class="sd">        Intended use is to write information about</span>
<span class="sd">        the current session into a locked file</span>

<span class="sd">        .. TODO::</span>
<span class="sd">         I should really subclass this out and create a way to add/remove rules</span>
<span class="sd">         from this import dict and from the is_incomplete_read_contact_info.</span>
<span class="sd">         Reference: Type Code with State/Strategy:</span>
<span class="sd">         https://sourcemaking.com/refactoring/replace-conditional-with-polymorphism</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: A full dictionary containing all of the different user info</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">contactInfo</span> <span class="o">=</span> <span class="n">project_member_contact_info</span><span class="p">()</span>
        <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">contactInfo</span><span class="p">))</span>
        <span class="n">currentUserInfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_network_collection</span><span class="p">()</span>
        <span class="n">outputDict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;USERNAME&quot;</span><span class="p">:</span> <span class="n">consts</span><span class="o">.</span><span class="n">USERNAME</span><span class="p">,</span>
                      <span class="s2">&quot;IP&quot;</span><span class="p">:</span> <span class="n">currentUserInfo</span><span class="p">[</span><span class="s1">&#39;IP&#39;</span><span class="p">],</span>
                      <span class="s2">&quot;MACHINE&quot;</span><span class="p">:</span> <span class="n">currentUserInfo</span><span class="p">[</span><span class="s1">&#39;MACHINE&#39;</span><span class="p">],</span>
                      <span class="s2">&quot;ROOM&quot;</span><span class="p">:</span> <span class="n">currentUserInfo</span><span class="p">[</span><span class="s1">&#39;ROOM&#39;</span><span class="p">],</span>
                      <span class="s2">&quot;USERFULLNAME&quot;</span><span class="p">:</span> <span class="n">contactInfo</span><span class="p">[</span><span class="s1">&#39;USERFULLNAME&#39;</span><span class="p">],</span>
                      <span class="s2">&quot;EMAIL&quot;</span><span class="p">:</span> <span class="n">contactInfo</span><span class="p">[</span><span class="s1">&#39;EMAIL&#39;</span><span class="p">],</span>  <span class="c1"># :::TO DO::: get user&#39;s email from file</span>
                      <span class="s2">&quot;PHONENUMBER&quot;</span><span class="p">:</span> <span class="n">contactInfo</span><span class="p">[</span><span class="s1">&#39;PHONENUMBER&#39;</span><span class="p">],</span>  <span class="c1"># ::: TO DO::: dynamically get phone and email info automatically</span>
                      <span class="s2">&quot;TIME&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%I:%M:%S&quot;</span><span class="p">),</span>
                      <span class="s2">&quot;DATE&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">/%m/%Y&quot;</span><span class="p">)}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lockedIPAddress</span> <span class="o">=</span> <span class="n">consts</span><span class="o">.</span><span class="n">IPADDRESS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lockedMachine</span> <span class="o">=</span> <span class="n">consts</span><span class="o">.</span><span class="n">HOSTNAME</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lockedUserFullName</span> <span class="o">=</span> <span class="n">contactInfo</span><span class="p">[</span><span class="s1">&#39;USERFULLNAME&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lockedUserName</span> <span class="o">=</span> <span class="n">contactInfo</span><span class="p">[</span><span class="s1">&#39;USERNAME&#39;</span><span class="p">]</span>  <span class="c1">#interchangeable with consts.USERNAME</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lockedEMail</span> <span class="o">=</span> <span class="n">contactInfo</span><span class="p">[</span><span class="s1">&#39;EMAIL&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lockedPhoneNumber</span> <span class="o">=</span> <span class="n">contactInfo</span><span class="p">[</span><span class="s1">&#39;PHONENUMBER&#39;</span><span class="p">]</span>
        <span class="n">LOGGER</span><span class="o">.</span><span class="n">debug</span><span class="p">([</span><span class="s2">&quot;AIE4608&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s1">&#39;contents&#39;</span><span class="p">:</span> <span class="n">outputDict</span><span class="p">,</span>
                                   <span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">outputDict</span></div>
    <span class="c1"># end collect_contact_info</span>

<div class="viewcode-block" id="NetworkManager.get_machine_number"><a class="viewcode-back" href="../../../wip/network.html#network.controller.network.NetworkManager.get_machine_number">[docs]</a>    <span class="k">def</span> <span class="nf">get_machine_number</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the machine number of the current user</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The current machine number of the user</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">machineNum</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">gethostbyname</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">gethostname</span><span class="p">())</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">machineNum</span></div>
    <span class="c1"># end get_machine_number</span>

<div class="viewcode-block" id="NetworkManager.get_room_number"><a class="viewcode-back" href="../../../wip/network.html#network.controller.network.NetworkManager.get_room_number">[docs]</a>    <span class="k">def</span> <span class="nf">get_room_number</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the room number of the current user</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The room number that the machine exists in</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">roomNum</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">gethostbyname</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">gethostname</span><span class="p">())</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">roomNum</span></div>
    <span class="c1"># end get_room_number</span>

<div class="viewcode-block" id="NetworkManager.get_network_collection"><a class="viewcode-back" href="../../../wip/network.html#network.controller.network.NetworkManager.get_network_collection">[docs]</a>    <span class="k">def</span> <span class="nf">get_network_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets a collection of network data about the user</span>
<span class="sd">        and packs it into a dict.</span>

<span class="sd">        Currently returns the room #, machine #, network ip, and ip prefix</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: All of the network-related data is returned as a single dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ip</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">gethostbyname</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">gethostname</span><span class="p">())</span>
        <span class="n">ipSplit</span> <span class="o">=</span> <span class="n">ip</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
        <span class="n">roomNum</span> <span class="o">=</span> <span class="n">ipSplit</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">machineNum</span> <span class="o">=</span> <span class="n">ipSplit</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">networkAddr</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ipSplit</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">outputH</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ROOM&#39;</span><span class="p">:</span> <span class="n">roomNum</span><span class="p">,</span>
                   <span class="s1">&#39;MACHINE&#39;</span><span class="p">:</span> <span class="n">machineNum</span><span class="p">,</span>
                   <span class="s1">&#39;NETWORKADDR&#39;</span><span class="p">:</span> <span class="n">networkAddr</span><span class="p">,</span>
                   <span class="s1">&#39;IP&#39;</span><span class="p">:</span> <span class="n">ip</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">outputH</span></div>
    <span class="c1"># end get_network_collection</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets and sets a handler which points to a file.</span>
<span class="sd">        By default, the requested file does not have to be any particular type</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: A file pointer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span>
    <span class="c1"># end @file.property</span>

    <span class="nd">@file.setter</span>
    <span class="k">def</span> <span class="nf">file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_h</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is the set method for the self._file attribute</span>

<span class="sd">        Args:</span>
<span class="sd">            file_h (str): The full path file handle</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_file</span> <span class="o">=</span> <span class="n">file_h</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lockedFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span> <span class="o">+</span> <span class="n">consts</span><span class="o">.</span><span class="n">LOCKED_NOTIFIER</span>
    <span class="c1"># end @file.setter</span>

    <span class="nd">@file.deleter</span>
    <span class="k">def</span> <span class="nf">file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is the delete method for the self._file attribute</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span>
    <span class="c1"># end @file.deleter</span>
    <span class="c1"># end file</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">read_contact_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads the contact information on the locked file being queried</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: Contact info about the user who currently locked the file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_lockedFile</span><span class="p">):</span>
            <span class="c1"># LOGGER.info([&#39;AIE7601&#39;, &#39;match_false&#39;], {&#39;file&#39;: self._file})</span>
            <span class="k">return</span> <span class="bp">None</span>

        <span class="n">contactInfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect_contact_info</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">contactInfo</span>
    <span class="c1"># end @read_contact_info.property</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">locked_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">            str: The full path to a locked file (may or may not actually exist)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lockedFile</span>
    <span class="c1"># end @locked_file.property</span>

    <span class="nd">@locked_file.setter</span>
    <span class="k">def</span> <span class="nf">locked_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Originally created to possibly have it so that setting the value to</span>
<span class="sd">        True/False would create/delete a locked file but that never happened</span>

<span class="sd">        .. Note::</span>
<span class="sd">         Currently does not have any network-related functionality built-in</span>

<span class="sd">        Args:</span>
<span class="sd">            value (str): The locked file name (full path). Overrides the default</span>
<span class="sd">                         locked file which is simply self.file +</span>
<span class="sd">                         consts.LOCKED_NOTIFIER</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lockedFile</span> <span class="o">=</span> <span class="n">value</span>
    <span class="c1"># end @locked_file.setter</span>

    <span class="nd">@locked_file.deleter</span>
    <span class="k">def</span> <span class="nf">locked_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Originally created to possibly have it so that deleting the attribute</span>
<span class="sd">        would delete a locked file but that never happened</span>

<span class="sd">        .. Note::</span>
<span class="sd">         Currently does not have any network-related functionality built-in</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lockedFile</span></div>
    <span class="c1"># end @locked_file.deleter</span>
    <span class="c1"># end locked_file</span>
<span class="c1"># end NetworkManager</span>


<span class="c1"># class SpreadSheetConnect(object):</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     .. Note::</span>
<span class="c1">#      Deprecated. Maya/Nuke/Houdini all run on Python 64 bit and, for whatever</span>
<span class="c1">#      reason, they don&#39;t accept pygame 64 bit as a valid library and won&#39;t play</span>
<span class="c1">#      music</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     def __init__(self, wks):</span>
<span class="c1">#         &quot;&quot;&quot;</span>
<span class="c1">#         Locked name does not necessarily exist but is the convention for</span>
<span class="c1">#         all locked file names.</span>
<span class="c1">#         &quot;&quot;&quot;</span>
<span class="c1">#         super(SpreadSheetConnect, self).__init__()</span>
<span class="c1">#         self.worksheets = wks</span>
<span class="c1">#     # end __init__</span>
<span class="c1">#</span>
<span class="c1">#     @property</span>
<span class="c1">#     def currentWorksheet(self):</span>
<span class="c1">#         return self._currentWorksheet</span>
<span class="c1">#     # end currentWorksheet.property</span>
<span class="c1">#</span>
<span class="c1">#     @currentWorksheet.setter</span>
<span class="c1">#     def currentWorksheet(self, sheet):</span>
<span class="c1">#         self._currentWorksheet = sheet</span>
<span class="c1">#     # end @currentWorksheet.setter</span>
<span class="c1">#</span>
<span class="c1">#     @currentWorksheet.deleter</span>
<span class="c1">#     def currentWorksheet(self):</span>
<span class="c1">#         self._currentWorksheet</span>
<span class="c1">#     # end @currentWorksheet.deleter</span>
<span class="c1">#</span>
<span class="c1">#     def get_cell_from_username(self, username=None):</span>
<span class="c1">#         &quot;&quot;&quot;</span>
<span class="c1">#         Gets the row/column pair by searching the spreadsheet</span>
<span class="c1">#         by using the current logged in user&#39;s username</span>
<span class="c1">#         &quot;&quot;&quot;</span>
<span class="c1">#         if username is not None:</span>
<span class="c1">#             output = self.currentWorksheet.find(username)</span>
<span class="c1">#         else:</span>
<span class="c1">#             output = self.currentWorksheet.find(self.userName)</span>
<span class="c1">#         return (output.col, output.row)</span>
<span class="c1">#     # end get_cell_from_username</span>
<span class="c1">#</span>
<span class="c1">#     def collect_contact_info(self):</span>
<span class="c1">#         self._userContactInfo = {&#39;USERNAME&#39;: self.userName,</span>
<span class="c1">#                                  &#39;PHONENUMBER&#39;: self.userPhoneNumber,</span>
<span class="c1">#                                  &#39;EMAIL&#39;: self.userEMail,</span>
<span class="c1">#                                  &#39;USERFULLNAME&#39;: self.userFullName}</span>
<span class="c1">#     # end collect_contact_info</span>
<span class="c1">#</span>
<span class="c1">#     @property</span>
<span class="c1">#     def userContactInfo(self):</span>
<span class="c1">#         &quot;&quot;&quot;</span>
<span class="c1">#         Gets contact information about the current user, returns a dict</span>
<span class="c1">#         with their information</span>
<span class="c1">#         &quot;&quot;&quot;</span>
<span class="c1">#         return self._userContactInfo</span>
<span class="c1">#     # end @collect_contact_info.property</span>
<span class="c1">#</span>
<span class="c1">#     @userContactInfo.setter</span>
<span class="c1">#     def userContactInfo(self, contactInfo):</span>
<span class="c1">#         credentialsList = [&#39;EMAIL&#39;, &#39;USERNAME&#39;, &#39;PHONENUMBER&#39;, &#39;USERFULLNAME&#39;]</span>
<span class="c1">#         for cred in credentialsList:</span>
<span class="c1">#             if cred not in contactInfo:</span>
<span class="c1">#                 break</span>
<span class="c1">#         else:</span>
<span class="c1">#             self._userContactInfo = contactInfo</span>
<span class="c1">#     # end @contactInfo.setter</span>
<span class="c1">#</span>
<span class="c1">#     @userContactInfo.deleter</span>
<span class="c1">#     def userContactInfo(self):</span>
<span class="c1">#         del self._userContactInfo</span>
<span class="c1">#     # end @contactInfo.deleter</span>
<span class="c1">#     # end contactInfo</span>
<span class="c1">#</span>
<span class="c1">#     @property</span>
<span class="c1">#     def userName(self):</span>
<span class="c1">#         return self._userName</span>
<span class="c1">#     # end username.property</span>
<span class="c1">#</span>
<span class="c1">#     @userName.setter</span>
<span class="c1">#     def userName(self, userName):</span>
<span class="c1">#         self._userName = userName</span>
<span class="c1">#     # end @userName.setter</span>
<span class="c1">#</span>
<span class="c1">#     @userName.deleter</span>
<span class="c1">#     def userName(self):</span>
<span class="c1">#         del self._userName</span>
<span class="c1">#     # end @userName.deleter</span>
<span class="c1">#     # end userName</span>
<span class="c1">#</span>
<span class="c1">#     @property</span>
<span class="c1">#     def userFullName(self):</span>
<span class="c1">#         return self._lockedUserFullName</span>
<span class="c1">#     # end @userFullName.property</span>
<span class="c1">#</span>
<span class="c1">#     @userFullName.setter</span>
<span class="c1">#     def userFullName(self, userFullName):</span>
<span class="c1">#         self._lockedUserFullName = userFullName</span>
<span class="c1">#     # end @userFullName.setter</span>
<span class="c1">#</span>
<span class="c1">#     @userFullName.deleter</span>
<span class="c1">#     def userFullName(self):</span>
<span class="c1">#         del self._lockedUserFullName</span>
<span class="c1">#     # end @userFullName.deleter</span>
<span class="c1">#     # end userFulleName</span>
<span class="c1">#</span>
<span class="c1">#     @property</span>
<span class="c1">#     def userEMail(self):</span>
<span class="c1">#         return self._userEMail</span>
<span class="c1">#     # end @get_email.property</span>
<span class="c1">#</span>
<span class="c1">#     @userEMail.setter</span>
<span class="c1">#     def userEMail(self, email):</span>
<span class="c1">#         self._userEMail = email</span>
<span class="c1">#     # end @userEMail.setter</span>
<span class="c1">#</span>
<span class="c1">#     @userEMail.deleter</span>
<span class="c1">#     def userEMail(self):</span>
<span class="c1">#         del self._userEMail</span>
<span class="c1">#     # end @userEMail.deleter</span>
<span class="c1">#     # end userEMail</span>
<span class="c1">#</span>
<span class="c1">#     @property</span>
<span class="c1">#     def userPhoneNumber(self):</span>
<span class="c1">#         return self._userPhoneNumber</span>
<span class="c1">#     # end @get_email.property</span>
<span class="c1">#</span>
<span class="c1">#     @userPhoneNumber.setter</span>
<span class="c1">#     def userPhoneNumber(self, phoneNumber):</span>
<span class="c1">#         self._userPhoneNumber = phoneNumber</span>
<span class="c1">#     # end @userEMail.setter</span>
<span class="c1">#</span>
<span class="c1">#     @userPhoneNumber.deleter</span>
<span class="c1">#     def userPhoneNumber(self):</span>
<span class="c1">#         del self._userPhoneNumber</span>
<span class="c1">#     # end @userPhoneNumber.deleter</span>
<span class="c1">#     # end userPhoneNumber</span>
<span class="c1"># # end SpreadsheetConnect</span>


<div class="viewcode-block" id="state_change_all"><a class="viewcode-back" href="../../../wip/network.html#network.controller.network.state_change_all">[docs]</a><span class="k">def</span> <span class="nf">state_change_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rootdir</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Locks/Unlocks every asset in the specified directory.</span>
<span class="sd">    Useful to lock/unlock all files in the project directory</span>

<span class="sd">    Args:</span>
<span class="sd">        rootdir (str): The folder to begin recursively finding files to change</span>
<span class="sd">        state (bool): True/False. True creates locked files, False deletes them</span>

<span class="sd">    Returns:</span>
<span class="sd">        NoneType: None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">consts</span><span class="o">.</span><span class="n">USERNAME</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">consts</span><span class="o">.</span><span class="n">REGISTERED_ADMINS</span><span class="p">:</span>
        <span class="n">LOGGER</span><span class="o">.</span><span class="n">critical</span><span class="p">([</span><span class="s1">&#39;AIE900&#39;</span><span class="p">],</span> <span class="p">{</span><span class="s1">&#39;user&#39;</span><span class="p">:</span> <span class="n">consts</span><span class="o">.</span><span class="n">USERNAME</span><span class="p">,</span>
                                     <span class="s1">&#39;admins&#39;</span><span class="p">:</span> <span class="n">consts</span><span class="o">.</span><span class="n">REGISTERED_ADMINS</span><span class="p">})</span>
        <span class="k">return</span> <span class="bp">None</span>

    <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="s2">&quot;unlock&quot;</span><span class="p">:</span>
        <span class="n">stateChange</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">elif</span> <span class="n">state</span> <span class="o">==</span> <span class="s2">&quot;lock&quot;</span><span class="p">:</span>
        <span class="n">stateChange</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">LOGGER</span><span class="o">.</span><span class="n">error</span><span class="p">([</span><span class="s1">&#39;NET7800&#39;</span><span class="p">],</span> <span class="p">{</span><span class="s1">&#39;script&#39;</span><span class="p">:</span><span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;parameter&#39;</span><span class="p">:</span><span class="n">stateChange</span><span class="p">})</span>
        <span class="k">return</span> <span class="bp">None</span>

    <span class="k">for</span> <span class="n">subdir</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">rootdir</span><span class="p">):</span>
        <span class="k">for</span> <span class="nb">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="n">networkManager</span> <span class="o">=</span> <span class="n">NetworkManager</span><span class="p">()</span>
            <span class="n">networkManager</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="nb">file</span>
            <span class="n">networkManager</span><span class="o">.</span><span class="n">locked</span> <span class="o">=</span> <span class="n">stateChange</span>  <span class="c1"># change all</span></div>
<span class="c1"># end state_change_all</span>

<span class="c1"># def get_crewmember_contact_info(credentials, wks, user=None):</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     .. Note::</span>
<span class="c1">#      Deprecated because Maya/Houdini/Nuke won&#39;t recognize pygame as a valid</span>
<span class="c1">#      module, even when using the x64 bit compiler</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     # receive worksheet info</span>
<span class="c1">#     gc = gspread.authorize(credentials)</span>
<span class="c1">#     wks = gc.open(wks)</span>
<span class="c1">#     sprdsht = SpreadSheetConnect(wks)</span>
<span class="c1">#     sprdsht.currentWorksheet = sprdsht.worksheets.sheet1</span>
<span class="c1">#     sprdsht.userName = user</span>
<span class="c1">#</span>
<span class="c1">#     # get username, full name, phone number, and email</span>
<span class="c1">#     if sprdsht.userName is None:</span>
<span class="c1">#         return None  # end script - nothing to search for</span>
<span class="c1">#</span>
<span class="c1">#     try:</span>
<span class="c1">#         userNameCell = sprdsht.currentWorksheet.find(sprdsht.userName)</span>
<span class="c1">#         userNameCellColLetter = chr((userNameCell.col - 1) + ord(&#39;A&#39;))</span>
<span class="c1">#         userNameCellRow = userNameCell.row</span>
<span class="c1">#     except gspread.exceptions.CellNotFound:</span>
<span class="c1">#         userNameCell = None</span>
<span class="c1">#     except:</span>
<span class="c1">#         raise</span>
<span class="c1">#</span>
<span class="c1">#     if userNameCell is not None:</span>
<span class="c1">#         cell = &quot;{c}{r}&quot;.format(c=userNameCellColLetter,</span>
<span class="c1">#                                r=userNameCellRow)</span>
<span class="c1">#         cell = sprdsht.currentWorksheet.acell(cell)</span>
<span class="c1">#         userNameCell = cell.value</span>
<span class="c1">#</span>
<span class="c1">#     # use and assume userNameCellRow as the row of information we need</span>
<span class="c1">#     # get full name</span>
<span class="c1">#     try:</span>
<span class="c1">#         userFullName = sprdsht.currentWorksheet.find(&quot;Name&quot;)</span>
<span class="c1">#         userFullNameColLetter = chr((userFullName.col - 1) + ord(&#39;A&#39;))</span>
<span class="c1">#     except gspread.exceptions.CellNotFound:</span>
<span class="c1">#         userFullName = None</span>
<span class="c1">#     except:</span>
<span class="c1">#         raise</span>
<span class="c1">#</span>
<span class="c1">#     if userFullName is not None:</span>
<span class="c1">#         cell = &quot;{c}{r}&quot;.format(c=userFullNameColLetter,</span>
<span class="c1">#                                r=userNameCellRow)</span>
<span class="c1">#         cell = sprdsht.currentWorksheet.acell(cell)</span>
<span class="c1">#         userFullName = cell.value</span>
<span class="c1">#</span>
<span class="c1">#     # get phone number</span>
<span class="c1">#     try:</span>
<span class="c1">#         userPhoneNumber = sprdsht.currentWorksheet.find(&quot;Phone Number&quot;)</span>
<span class="c1">#         userPhoneNumberColLetter = chr((userPhoneNumber.col - 1) + ord(&#39;A&#39;))</span>
<span class="c1">#     except gspread.exceptions.CellNotFound:</span>
<span class="c1">#         userPhoneNumber = None</span>
<span class="c1">#     except:</span>
<span class="c1">#         raise</span>
<span class="c1">#</span>
<span class="c1">#     if userPhoneNumber is not None:</span>
<span class="c1">#         cell = &quot;{c}{r}&quot;.format(c=userPhoneNumberColLetter,</span>
<span class="c1">#                                r=userNameCellRow)</span>
<span class="c1">#         cell = sprdsht.currentWorksheet.acell(cell)</span>
<span class="c1">#         userPhoneNumber = cell.value</span>
<span class="c1">#</span>
<span class="c1">#     # get EMail</span>
<span class="c1">#     try:</span>
<span class="c1">#         userEMail = sprdsht.currentWorksheet.find(&quot;Email&quot;)</span>
<span class="c1">#         userEMailColLetter = chr((userEMail.col - 1) + ord(&#39;A&#39;))</span>
<span class="c1">#     except gspread.exceptions.CellNotFound:</span>
<span class="c1">#         userEMail = None</span>
<span class="c1">#     except:</span>
<span class="c1">#         raise</span>
<span class="c1">#</span>
<span class="c1">#     if userEMail is not None:</span>
<span class="c1">#         cell = &quot;{c}{r}&quot;.format(c=userEMailColLetter,</span>
<span class="c1">#                                r=userNameCellRow)</span>
<span class="c1">#         cell = sprdsht.currentWorksheet.acell(cell)</span>
<span class="c1">#         userEMail = cell.value</span>
<span class="c1">#</span>
<span class="c1">#     sprdsht.userPhoneNumber = (203,722,6620)</span>
<span class="c1">#     sprdsht.userFullName = userFullName</span>
<span class="c1">#     sprdsht.userPhoneNumber = userPhoneNumber</span>
<span class="c1">#     sprdsht.userEMail = userEMail</span>
<span class="c1">#     sprdsht.collect_contact_info()</span>
<span class="c1">#     return sprdsht.userContactInfo</span>
<span class="c1"># # end get_crewmember_contact_info</span>

<span class="c1"># DEPRECATED - Requires a 32bit python installation - Note 66</span>
<span class="c1"># Maya does not support this - and although it can be forced</span>
<span class="c1"># it will likely be in vein since Nuke and Houdini are also 64 bti</span>
<span class="c1"># if you still want to switch, info is here:</span>
<span class="c1"># https://stackoverflow.com/questions/20370100/changing-python-version-in-maya</span>
<span class="c1"># https://stackoverflow.com/questions/14656593/how-do-i-change-the-python-version-in-maya-2013/14706115#14706115</span>
<span class="c1"># def project_member_contact_info(user=None, wks=None):</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     Gets the contact info of a crewmember on the project</span>
<span class="c1">#     by accessing the private google-docs page</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     LOGGER.info(&quot;START&quot;)</span>
<span class="c1">#     userName = getpass.getuser()</span>
<span class="c1">#     if user is not None:</span>
<span class="c1">#         userName = user</span>

<span class="c1">#     if &#39;PIPELINE_DIR&#39; in os.environ:</span>
<span class="c1">#         baseDir = os.environ[&#39;PIPELINE_DIR&#39;]</span>
<span class="c1">#         crewSheet = os.path.join(baseDir,</span>
<span class="c1">#                              &#39;latest_CONFIG&#39;,</span>
<span class="c1">#                              &#39;conf_INFO&#39;,</span>
<span class="c1">#                              &#39;crew_sheet_gdocs_auth.json&#39;)</span>
<span class="c1">#     elif &#39;PROJECT_DIR&#39; in os.environ and \</span>
<span class="c1">#             &#39;Pipeline&#39; in os.listdir(os.environ[&#39;PROJECT_DIR&#39;]):</span>
<span class="c1">#         baseDir = os.path.join(os.environ[&#39;PROJECT_DIR&#39;], &#39;Pipeline&#39;)</span>
<span class="c1">#         LOGGER.info(&quot;Found path: {f}&quot;.format(baseDir))</span>
<span class="c1">#         crewSheet = os.path.join(baseDir,</span>
<span class="c1">#                              &#39;the_LATEST&#39;,</span>
<span class="c1">#                              &#39;latest_CONFIG&#39;,</span>
<span class="c1">#                              &#39;conf_INFO&#39;,</span>
<span class="c1">#                              &#39;crew_sheet_gdocs_auth.json&#39;)</span>
<span class="c1">#     else:</span>
<span class="c1">#         LOGGER.critical([&#39;AIE9103&#39;, &#39;match_false&#39;],</span>
<span class="c1">#                         {&#39;script&#39;: os.path.basename(__file__)})</span>

<span class="c1">#     json_key = json.load(open(crewSheet))</span>
<span class="c1">#     scope = [&#39;https://spreadsheets.google.com/feeds&#39;]</span>
<span class="c1">#     credentials = SignedJwtAssertionCredentials(json_key[&#39;client_email&#39;],</span>
<span class="c1">#                                                 json_key[&#39;private_key&#39;].encode(),</span>
<span class="c1">#                                                 scope)</span>
<span class="c1">#     if wks is None:</span>
<span class="c1">#         wks = &#39;Crew_spreadsheet_dup_test&#39;</span>

<span class="c1">#     contactInfo = get_crewmember_contact_info(credentials, wks, userName)</span>
<span class="c1">#     return contactInfo</span>
<span class="c1"># # end project_member_contact_info</span>


<div class="viewcode-block" id="project_member_contact_info"><a class="viewcode-back" href="../../../wip/network.html#network.controller.network.project_member_contact_info">[docs]</a><span class="k">def</span> <span class="nf">project_member_contact_info</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">wks</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reads crewmember information from consts.CREWSHEET using consts.USERNAME as</span>
<span class="sd">    the key and gets that user&#39;s information</span>

<span class="sd">    Args:</span>
<span class="sd">        user (str): Overrides consts.USERNAME if not None</span>
<span class="sd">        wks (str): The full path to a JSON file which contains a dictionary</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: The user&#39;s information</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">userName</span> <span class="o">=</span> <span class="n">consts</span><span class="o">.</span><span class="n">USERNAME</span>
    <span class="k">if</span> <span class="n">user</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">userName</span> <span class="o">=</span> <span class="n">user</span>

    <span class="k">if</span> <span class="n">wks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">crewsheet</span> <span class="o">=</span> <span class="n">wks</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">crewsheet</span> <span class="o">=</span> <span class="n">consts</span><span class="o">.</span><span class="n">CREWSHEET</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">crewsheet</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">crewDict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">crewDict</span> <span class="o">=</span> <span class="n">omnibus</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">crewDict</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">userName</span> <span class="ow">in</span> <span class="n">crewDict</span><span class="p">:</span>
        <span class="n">userInfo</span> <span class="o">=</span> <span class="n">crewDict</span><span class="p">[</span><span class="n">userName</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">userInfo</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">return</span> <span class="n">userInfo</span></div>
<span class="c1"># end project_member_contact_info</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="k">print</span> <span class="p">(</span><span class="n">__doc__</span><span class="p">)</span>
    <span class="c1"># print project_member_contact_info()</span>
    <span class="c1"># networkM = NetworkManager()</span>
    <span class="c1"># networkM.collect_contact_info()</span>

    <span class="c1"># print project_member_contact_info(wks=&#39;Crew_spreadsheet_dup_test&#39;)</span>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Colin Kennedy.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'1.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>